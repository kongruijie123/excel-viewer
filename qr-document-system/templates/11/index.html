<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡æ¡£å±•ç¤ºç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #4CAF50, #2196F3);
            color: white;
            text-align: center;
            padding: 40px 20px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-content {
            padding: 40px;
        }

        .document-sections {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .section-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .section-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .section-card h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .file-upload {
            margin-bottom: 20px;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            cursor: pointer;
            width: 100%;
        }

        .file-input {
            position: absolute;
            left: -9999px;
        }

        .file-input-label {
            display: block;
            padding: 12px 20px;
            background: #007bff;
            color: white;
            border-radius: 8px;
            text-align: center;
            transition: background 0.3s;
            cursor: pointer;
        }

        .file-input-label:hover {
            background: #0056b3;
        }

        .upload-btn {
            width: 100%;
            padding: 12px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
            transition: background 0.3s;
        }

        .upload-btn:hover {
            background: #218838;
        }

        .upload-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }

        .content-display {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            border: 1px solid #ddd;
            max-height: 400px;
            overflow-y: auto;
            display: none;
        }

        .error {
            color: #dc3545;
            margin-top: 10px;
        }

        .success {
            color: #28a745;
            margin-top: 10px;
        }

        .slide-content {
            border: 1px solid #ddd;
            margin-bottom: 15px;
            border-radius: 8px;
        }

        .slide-header {
            background: #f8f9fa;
            padding: 10px 15px;
            font-weight: bold;
            border-bottom: 1px solid #ddd;
        }

        .slide-body {
            padding: 15px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        table th, table td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        table th {
            background-color: #f8f9fa;
            font-weight: bold;
        }

        .loading {
            display: none;
            text-align: center;
            color: #007bff;
            margin-top: 10px;
        }

        .file-name {
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }

        .qr-display-section {
            margin-bottom: 40px;
        }

        .qr-result-card {
            background: linear-gradient(135deg, #4CAF50 0%, #2196F3 100%);
            color: white;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        .qr-result-card h2 {
            margin-bottom: 15px;
            font-size: 1.8em;
        }

        .qr-result-card > p {
            margin-bottom: 25px;
            font-size: 1.1em;
            opacity: 0.9;
        }

        .qr-image-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 25px auto;
            display: inline-block;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .qr-image-container img {
            max-width: 200px;
            height: auto;
            border-radius: 8px;
        }

        .qr-info {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .qr-info p {
            margin-bottom: 8px;
            font-size: 14px;
        }

        .qr-info a {
            color: #FFE082;
            text-decoration: none;
            font-weight: bold;
        }

        .qr-info a:hover {
            text-decoration: underline;
        }

        .new-session-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .new-session-btn:hover {
            background: white;
            color: #4CAF50;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“„ æ–‡æ¡£å±•ç¤ºç³»ç»Ÿ</h1>
            <p>ä¸Šä¼ å¹¶å±•ç¤ºæ‚¨çš„Wordã€PPTå’ŒExcelæ–‡ä»¶</p>
        </div>

        <div class="main-content">
            <!-- äºŒç»´ç å±•ç¤ºåŒºåŸŸ -->
            <div class="qr-display-section" id="qr-display-section" style="display: none;">
                <div class="qr-result-card">
                    <h2>ğŸ“± æ‰«ææŸ¥çœ‹æ–‡æ¡£</h2>
                    <p>æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼ä½¿ç”¨æ‰‹æœºæ‰«æä¸‹æ–¹äºŒç»´ç ç›´æ¥æŸ¥çœ‹æ–‡æ¡£å†…å®¹</p>
                    <div class="qr-image-container">
                        <img id="generated-qr" src="" alt="ç”Ÿæˆçš„äºŒç»´ç " />
                    </div>
                    <div class="qr-info">
                        <p><strong>ä¼šè¯ID:</strong> <span id="session-id"></span></p>
                        <p><strong>ç›´æ¥è®¿é—®:</strong> <a id="direct-link" href="" target="_blank"></a></p>
                        <p><strong>å·²ä¸Šä¼ æ–‡ä»¶:</strong> <span id="uploaded-count">0</span> ä¸ª</p>
                    </div>
                    <button class="new-session-btn" onclick="createNewSession()">åˆ›å»ºæ–°ä¼šè¯</button>
                </div>
            </div>

            <div class="document-sections">
                <!-- Wordæ–‡æ¡£åŒºåŸŸ -->
                <div class="section-card">
                    <h2>ğŸ“ Wordæ–‡æ¡£</h2>
                    <div class="file-upload">
                        <div class="file-input-wrapper">
                            <input type="file" id="word-file" class="file-input" accept=".docx" data-type="word">
                            <label for="word-file" class="file-input-label">é€‰æ‹©Wordæ–‡ä»¶ (.docx)</label>
                        </div>
                        <div class="file-name" id="word-file-name"></div>
                        <button class="upload-btn" onclick="uploadFile('word')" id="word-upload-btn" disabled>ä¸Šä¼ Wordæ–‡æ¡£</button>
                        <div class="loading" id="word-loading">æ­£åœ¨å¤„ç†æ–‡ä»¶...</div>
                        <div class="error" id="word-error"></div>
                        <div class="success" id="word-success"></div>
                    </div>
                    <div class="content-display" id="word-content"></div>
                </div>

                <!-- PPTæ¼”ç¤ºæ–‡ç¨¿åŒºåŸŸ -->
                <div class="section-card">
                    <h2>ğŸ“Š PPTæ¼”ç¤ºæ–‡ç¨¿</h2>
                    <div class="file-upload">
                        <div class="file-input-wrapper">
                            <input type="file" id="ppt-file" class="file-input" accept=".pptx" data-type="ppt">
                            <label for="ppt-file" class="file-input-label">é€‰æ‹©PPTæ–‡ä»¶ (.pptx)</label>
                        </div>
                        <div class="file-name" id="ppt-file-name"></div>
                        <button class="upload-btn" onclick="uploadFile('ppt')" id="ppt-upload-btn" disabled>ä¸Šä¼ PPTæ–‡æ¡£</button>
                        <div class="loading" id="ppt-loading">æ­£åœ¨å¤„ç†æ–‡ä»¶...</div>
                        <div class="error" id="ppt-error"></div>
                        <div class="success" id="ppt-success"></div>
                    </div>
                    <div class="content-display" id="ppt-content"></div>
                </div>

                <!-- Excelè¡¨æ ¼åŒºåŸŸ -->
                <div class="section-card">
                    <h2>ğŸ“ˆ Excelè¡¨æ ¼</h2>
                    <div class="file-upload">
                        <div class="file-input-wrapper">
                            <input type="file" id="excel-file" class="file-input" accept=".xlsx,.xls" data-type="excel">
                            <label for="excel-file" class="file-input-label">é€‰æ‹©Excelæ–‡ä»¶ (.xlsx/.xls)</label>
                        </div>
                        <div class="file-name" id="excel-file-name"></div>
                        <button class="upload-btn" onclick="uploadFile('excel')" id="excel-upload-btn" disabled>ä¸Šä¼ Excelæ–‡æ¡£</button>
                        <div class="loading" id="excel-loading">æ­£åœ¨å¤„ç†æ–‡ä»¶...</div>
                        <div class="error" id="excel-error"></div>
                        <div class="success" id="excel-success"></div>
                    </div>
                    <div class="content-display" id="excel-content"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥æ˜¯å¦æœ‰å½“å‰ä¼šè¯
        window.addEventListener('load', function() {
            checkCurrentSession();
        });

        // æ£€æŸ¥å½“å‰ä¼šè¯
        function checkCurrentSession() {
            fetch('/current_qr')
                .then(response => response.json())
                .then(data => {
                    if (data.has_qr) {
                        showGeneratedQR({
                            qr_filename: data.qr_filename,
                            qr_url: data.qr_url,
                            session_id: data.session_id
                        });
                        document.getElementById('uploaded-count').textContent = data.document_count;
                    }
                })
                .catch(error => {
                    console.log('æ²¡æœ‰å½“å‰ä¼šè¯');
                });
        }

        // æ–‡ä»¶é€‰æ‹©ç›‘å¬
        document.querySelectorAll('.file-input').forEach(input => {
            input.addEventListener('change', function() {
                const type = this.dataset.type;
                const uploadBtn = document.getElementById(`${type}-upload-btn`);
                const fileName = document.getElementById(`${type}-file-name`);
                const errorDiv = document.getElementById(`${type}-error`);
                const successDiv = document.getElementById(`${type}-success`);

                // æ¸…é™¤ä¹‹å‰çš„æ¶ˆæ¯
                errorDiv.textContent = '';
                successDiv.textContent = '';

                if (this.files.length > 0) {
                    uploadBtn.disabled = false;
                    fileName.textContent = `å·²é€‰æ‹©: ${this.files[0].name}`;
                } else {
                    uploadBtn.disabled = true;
                    fileName.textContent = '';
                }
            });
        });

        // ä¸Šä¼ æ–‡ä»¶å‡½æ•°
        function uploadFile(type) {
            const fileInput = document.getElementById(`${type}-file`);
            const loadingDiv = document.getElementById(`${type}-loading`);
            const errorDiv = document.getElementById(`${type}-error`);
            const successDiv = document.getElementById(`${type}-success`);
            const contentDiv = document.getElementById(`${type}-content`);
            const uploadBtn = document.getElementById(`${type}-upload-btn`);

            // æ¸…é™¤ä¹‹å‰çš„æ¶ˆæ¯å’Œå†…å®¹
            errorDiv.textContent = '';
            successDiv.textContent = '';
            contentDiv.style.display = 'none';

            if (!fileInput.files.length) {
                errorDiv.textContent = 'è¯·å…ˆé€‰æ‹©æ–‡ä»¶';
                return;
            }

            const file = fileInput.files[0];
            const formData = new FormData();
            formData.append('file', file);
            formData.append('file_type', type);

            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            loadingDiv.style.display = 'block';
            uploadBtn.disabled = true;

            fetch('/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                loadingDiv.style.display = 'none';
                uploadBtn.disabled = false;

                if (data.success) {
                    successDiv.textContent = 'æ–‡ä»¶ä¸Šä¼ å¹¶å¤„ç†æˆåŠŸï¼';
                    displayContent(type, data.content, data.type);

                    // æ˜¾ç¤ºç”Ÿæˆçš„äºŒç»´ç 
                    if (data.qr_url) {
                        showGeneratedQR(data);
                    }
                } else {
                    errorDiv.textContent = data.error || 'å¤„ç†æ–‡ä»¶æ—¶å‡ºé”™';
                }
            })
            .catch(error => {
                loadingDiv.style.display = 'none';
                uploadBtn.disabled = false;
                errorDiv.textContent = 'ç½‘ç»œé”™è¯¯: ' + error.message;
            });
        }

        // æ˜¾ç¤ºå†…å®¹å‡½æ•°
        function displayContent(type, content, contentType) {
            const contentDiv = document.getElementById(`${type}-content`);

            if (contentType === 'text') {
                contentDiv.innerHTML = `<pre>${content}</pre>`;
            } else if (contentType === 'table') {
                let html = '';
                if (content.error) {
                    html = `<p class="error">${content.error}</p>`;
                } else {
                    for (const [sheetName, tableHtml] of Object.entries(content)) {
                        html += `<h3>å·¥ä½œè¡¨: ${sheetName}</h3>${tableHtml}<br>`;
                    }
                }
                contentDiv.innerHTML = html;
            } else if (contentType === 'slides') {
                let html = '';
                if (content[0] && content[0].error) {
                    html = `<p class="error">${content[0].error}</p>`;
                } else {
                    content.forEach(slide => {
                        html += `
                            <div class="slide-content">
                                <div class="slide-header">å¹»ç¯ç‰‡ ${slide.slide_number}</div>
                                <div class="slide-body">
                                    ${slide.content.map(text => `<p>${text}</p>`).join('')}
                                </div>
                            </div>
                        `;
                    });
                }
                contentDiv.innerHTML = html;
            }

            contentDiv.style.display = 'block';
        }

        // æ˜¾ç¤ºç”Ÿæˆçš„äºŒç»´ç 
        function showGeneratedQR(data) {
            const qrSection = document.getElementById('qr-display-section');
            const qrImg = document.getElementById('generated-qr');
            const sessionIdSpan = document.getElementById('session-id');
            const directLink = document.getElementById('direct-link');
            const uploadedCount = document.getElementById('uploaded-count');

            qrImg.src = `/static/${data.qr_filename}`;
            sessionIdSpan.textContent = data.session_id;
            directLink.href = data.qr_url;
            directLink.textContent = data.qr_url;

            // è®¡ç®—ä¸Šä¼ æ–‡ä»¶æ•°é‡
            fetch('/current_qr')
                .then(response => response.json())
                .then(result => {
                    if (result.has_qr) {
                        uploadedCount.textContent = result.document_count;
                    }
                });

            qrSection.style.display = 'block';
            qrSection.scrollIntoView({ behavior: 'smooth' });
        }

        // åˆ›å»ºæ–°ä¼šè¯
        function createNewSession() {
            fetch('/new_session')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // éšè—äºŒç»´ç åŒºåŸŸ
                        document.getElementById('qr-display-section').style.display = 'none';

                        // æ¸…ç©ºæ‰€æœ‰å†…å®¹æ˜¾ç¤ºåŒºåŸŸ
                        ['word', 'ppt', 'excel'].forEach(type => {
                            const contentDiv = document.getElementById(`${type}-content`);
                            contentDiv.style.display = 'none';
                            contentDiv.innerHTML = '';

                            // é‡ç½®æ–‡ä»¶è¾“å…¥
                            document.getElementById(`${type}-file`).value = '';
                            document.getElementById(`${type}-file-name`).textContent = '';
                            document.getElementById(`${type}-upload-btn`).disabled = true;

                            // æ¸…é™¤çŠ¶æ€æ¶ˆæ¯
                            document.getElementById(`${type}-error`).textContent = '';
                            document.getElementById(`${type}-success`).textContent = '';
                        });

                        alert('æ–°ä¼šè¯å·²åˆ›å»ºï¼ç°åœ¨å¯ä»¥ä¸Šä¼ æ–°çš„æ–‡ä»¶ã€‚');
                    }
                })
                .catch(error => {
                    alert('åˆ›å»ºæ–°ä¼šè¯å¤±è´¥: ' + error.message);
                });
        }
    </script>
</body>
</html>
<!--<!DOCTYPE html>-->
<!--<html lang="zh-CN">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>æ–‡æ¡£ä¸Šä¼ ä¸æŸ¥çœ‹ç³»ç»Ÿ</title>-->
<!--    <style>-->
<!--        * {-->
<!--            margin: 0;-->
<!--            padding: 0;-->
<!--            box-sizing: border-box;-->
<!--        }-->

<!--        body {-->
<!--            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;-->
<!--            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);-->
<!--            min-height: 100vh;-->
<!--            padding: 20px;-->
<!--        }-->

<!--        .container {-->
<!--            max-width: 900px;-->
<!--            margin: 0 auto;-->
<!--            background: white;-->
<!--            border-radius: 20px;-->
<!--            box-shadow: 0 25px 50px rgba(0,0,0,0.15);-->
<!--            overflow: hidden;-->
<!--        }-->

<!--        .header {-->
<!--            background: linear-gradient(45deg, #4CAF50, #2196F3);-->
<!--            color: white;-->
<!--            padding: 50px 40px;-->
<!--            text-align: center;-->
<!--            position: relative;-->
<!--            overflow: hidden;-->
<!--        }-->

<!--        .header::before {-->
<!--            content: '';-->
<!--            position: absolute;-->
<!--            top: -50%;-->
<!--            left: -50%;-->
<!--            width: 200%;-->
<!--            height: 200%;-->
<!--            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);-->
<!--            transform: rotate(45deg);-->
<!--            animation: shimmer 3s ease-in-out infinite;-->
<!--        }-->

<!--        @keyframes shimmer {-->
<!--            0%, 100% { transform: translateX(-100%) rotate(45deg); }-->
<!--            50% { transform: translateX(100%) rotate(45deg); }-->
<!--        }-->

<!--        .header h1 {-->
<!--            font-size: 3em;-->
<!--            margin-bottom: 20px;-->
<!--            position: relative;-->
<!--            z-index: 1;-->
<!--        }-->

<!--        .header p {-->
<!--            font-size: 1.2em;-->
<!--            opacity: 0.9;-->
<!--            position: relative;-->
<!--            z-index: 1;-->
<!--        }-->

<!--        .main-content {-->
<!--            padding: 50px 40px;-->
<!--        }-->

<!--        .upload-section {-->
<!--            background: linear-gradient(135deg, #f8f9fa, #ffffff);-->
<!--            border-radius: 20px;-->
<!--            padding: 40px;-->
<!--            margin-bottom: 40px;-->
<!--            box-shadow: 0 10px 30px rgba(0,0,0,0.05);-->
<!--            border: 2px dashed #dee2e6;-->
<!--            transition: all 0.3s ease;-->
<!--        }-->

<!--        .upload-section:hover {-->
<!--            border-color: #4CAF50;-->
<!--            box-shadow: 0 15px 40px rgba(76,175,80,0.1);-->
<!--        }-->

<!--        .file-types {-->
<!--            display: grid;-->
<!--            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));-->
<!--            gap: 20px;-->
<!--            margin-bottom: 30px;-->
<!--        }-->

<!--        .file-type {-->
<!--            background: white;-->
<!--            border-radius: 15px;-->
<!--            padding: 30px 20px;-->
<!--            text-align: center;-->
<!--            box-shadow: 0 8px 25px rgba(0,0,0,0.1);-->
<!--            cursor: pointer;-->
<!--            transition: all 0.3s ease;-->
<!--            border: 2px solid transparent;-->
<!--        }-->

<!--        .file-type:hover {-->
<!--            transform: translateY(-5px);-->
<!--            box-shadow: 0 15px 40px rgba(0,0,0,0.15);-->
<!--        }-->

<!--        .file-type.selected {-->
<!--            border-color: #4CAF50;-->
<!--            background: linear-gradient(135deg, #e8f5e8, #ffffff);-->
<!--        }-->

<!--        .file-type .icon {-->
<!--            font-size: 3em;-->
<!--            margin-bottom: 15px;-->
<!--        }-->

<!--        .file-type h3 {-->
<!--            color: #2c3e50;-->
<!--            margin-bottom: 10px;-->
<!--        }-->

<!--        .file-type p {-->
<!--            color: #6c757d;-->
<!--            font-size: 0.9em;-->
<!--        }-->

<!--        .upload-form {-->
<!--            text-align: center;-->
<!--        }-->

<!--        .file-input-container {-->
<!--            position: relative;-->
<!--            display: inline-block;-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .file-input {-->
<!--            position: absolute;-->
<!--            opacity: 0;-->
<!--            width: 100%;-->
<!--            height: 100%;-->
<!--            cursor: pointer;-->
<!--        }-->

<!--        .file-input-label {-->
<!--            display: inline-block;-->
<!--            padding: 15px 40px;-->
<!--            background: linear-gradient(45deg, #007bff, #0056b3);-->
<!--            color: white;-->
<!--            border-radius: 30px;-->
<!--            cursor: pointer;-->
<!--            font-weight: 500;-->
<!--            font-size: 16px;-->
<!--            transition: all 0.3s ease;-->
<!--            box-shadow: 0 6px 20px rgba(0,123,255,0.3);-->
<!--        }-->

<!--        .file-input-label:hover {-->
<!--            transform: translateY(-3px);-->
<!--            box-shadow: 0 10px 30px rgba(0,123,255,0.4);-->
<!--        }-->

<!--        .upload-btn {-->
<!--            padding: 15px 50px;-->
<!--            background: linear-gradient(45deg, #28a745, #20c997);-->
<!--            color: white;-->
<!--            border: none;-->
<!--            border-radius: 30px;-->
<!--            font-size: 16px;-->
<!--            font-weight: 500;-->
<!--            cursor: pointer;-->
<!--            transition: all 0.3s ease;-->
<!--            box-shadow: 0 6px 20px rgba(40,167,69,0.3);-->
<!--            margin-left: 15px;-->
<!--        }-->

<!--        .upload-btn:hover {-->
<!--            transform: translateY(-3px);-->
<!--            box-shadow: 0 10px 30px rgba(40,167,69,0.4);-->
<!--        }-->

<!--        .upload-btn:disabled {-->
<!--            opacity: 0.6;-->
<!--            cursor: not-allowed;-->
<!--            transform: none;-->
<!--        }-->

<!--        .qr-section {-->
<!--            background: linear-gradient(135deg, #fff3cd, #ffffff);-->
<!--            border-radius: 20px;-->
<!--            padding: 40px;-->
<!--            text-align: center;-->
<!--            border: 2px solid #ffeaa7;-->
<!--        }-->

<!--        .qr-section h2 {-->
<!--            color: #2c3e50;-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .qr-code {-->
<!--            max-width: 200px;-->
<!--            margin: 20px auto;-->
<!--            border-radius: 10px;-->
<!--            box-shadow: 0 8px 25px rgba(0,0,0,0.1);-->
<!--        }-->

<!--        .status-message {-->
<!--            margin: 20px 0;-->
<!--            padding: 15px;-->
<!--            border-radius: 10px;-->
<!--            display: none;-->
<!--        }-->

<!--        .status-message.success {-->
<!--            background: linear-gradient(135deg, #d4edda, #ffffff);-->
<!--            color: #155724;-->
<!--            border: 2px solid #c3e6cb;-->
<!--        }-->

<!--        .status-message.error {-->
<!--            background: linear-gradient(135deg, #f8d7da, #ffffff);-->
<!--            color: #721c24;-->
<!--            border: 2px solid #f5c6cb;-->
<!--        }-->

<!--        .nav-actions {-->
<!--            margin-top: 30px;-->
<!--            display: flex;-->
<!--            gap: 15px;-->
<!--            justify-content: center;-->
<!--        }-->

<!--        .nav-btn {-->
<!--            padding: 12px 24px;-->
<!--            background: linear-gradient(45deg, #6c757d, #5a6268);-->
<!--            color: white;-->
<!--            text-decoration: none;-->
<!--            border-radius: 25px;-->
<!--            font-size: 14px;-->
<!--            font-weight: 500;-->
<!--            transition: all 0.3s ease;-->
<!--            box-shadow: 0 4px 15px rgba(108,117,125,0.3);-->
<!--        }-->

<!--        .nav-btn:hover {-->
<!--            transform: translateY(-2px);-->
<!--            box-shadow: 0 8px 25px rgba(108,117,125,0.4);-->
<!--        }-->

<!--        .loading {-->
<!--            display: none;-->
<!--            text-align: center;-->
<!--            margin: 20px 0;-->
<!--        }-->

<!--        .spinner {-->
<!--            border: 4px solid #f3f3f3;-->
<!--            border-top: 4px solid #4CAF50;-->
<!--            border-radius: 50%;-->
<!--            width: 40px;-->
<!--            height: 40px;-->
<!--            animation: spin 1s linear infinite;-->
<!--            margin: 0 auto 15px;-->
<!--        }-->

<!--        @keyframes spin {-->
<!--            0% { transform: rotate(0deg); }-->
<!--            100% { transform: rotate(360deg); }-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--    <div class="container">-->
<!--        <div class="header">-->
<!--            <h1>ğŸ“„ æ–‡æ¡£æŸ¥çœ‹å™¨</h1>-->
<!--            <p>æ”¯æŒ Wordã€PPTã€Excel æ–‡æ¡£ä¸Šä¼ ä¸åœ¨çº¿æŸ¥çœ‹</p>-->
<!--        </div>-->

<!--        <div class="main-content">-->
<!--            &lt;!&ndash; ä¸Šä¼ åŒºåŸŸ &ndash;&gt;-->
<!--            <div class="upload-section">-->
<!--                <h2 style="text-align: center; margin-bottom: 30px; color: #2c3e50;">é€‰æ‹©æ–‡æ¡£ç±»å‹</h2>-->

<!--                <div class="file-types">-->
<!--                    <div class="file-type" onclick="selectFileType('word')">-->
<!--                        <div class="icon">ğŸ“</div>-->
<!--                        <h3>Word æ–‡æ¡£</h3>-->
<!--                        <p>æ”¯æŒ .docx æ ¼å¼</p>-->
<!--                    </div>-->
<!--                    <div class="file-type" onclick="selectFileType('ppt')">-->
<!--                        <div class="icon">ğŸ“Š</div>-->
<!--                        <h3>PPT æ¼”ç¤ºæ–‡ç¨¿</h3>-->
<!--                        <p>æ”¯æŒ .pptx æ ¼å¼</p>-->
<!--                    </div>-->
<!--                    <div class="file-type" onclick="selectFileType('excel')">-->
<!--                        <div class="icon">ğŸ“ˆ</div>-->
<!--                        <h3>Excel è¡¨æ ¼</h3>-->
<!--                        <p>æ”¯æŒ .xlsx .xls æ ¼å¼</p>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <form class="upload-form" enctype="multipart/form-data">-->
<!--                    <div class="file-input-container">-->
<!--                        <input type="file" id="fileInput" class="file-input" accept=".docx,.pptx,.xlsx,.xls">-->
<!--                        <label for="fileInput" class="file-input-label">-->
<!--                            ğŸ“ é€‰æ‹©æ–‡ä»¶-->
<!--                        </label>-->
<!--                    </div>-->
<!--                    <button type="button" class="upload-btn" onclick="uploadFile()">-->
<!--                        ğŸš€ ä¸Šä¼ æ–‡æ¡£-->
<!--                    </button>-->
<!--                </form>-->

<!--                <div class="loading">-->
<!--                    <div class="spinner"></div>-->
<!--                    <p>æ­£åœ¨å¤„ç†æ–‡æ¡£...</p>-->
<!--                </div>-->

<!--                <div class="status-message" id="statusMessage"></div>-->
<!--            </div>-->

<!--            &lt;!&ndash; äºŒç»´ç åŒºåŸŸ &ndash;&gt;-->
<!--            <div class="qr-section">-->
<!--                <h2>ğŸ“± æ‰«æäºŒç»´ç æŸ¥çœ‹</h2>-->
<!--                <p style="color: #6c757d; margin-bottom: 20px;">ä¸Šä¼ æ–‡æ¡£åï¼Œæ‰«æäºŒç»´ç åœ¨æ‰‹æœºä¸ŠæŸ¥çœ‹å†…å®¹</p>-->
<!--                <div id="qrContainer">-->
<!--                    <p style="color: #6c757d;">ä¸Šä¼ æ–‡æ¡£åå°†ç”ŸæˆäºŒç»´ç </p>-->
<!--                </div>-->

<!--                <div class="nav-actions">-->
<!--                    <a href="#" class="nav-btn" onclick="newSession()">ğŸ”„ æ–°å»ºä¼šè¯</a>-->
<!--                    <a href="/qr" class="nav-btn">ğŸ” æŸ¥çœ‹äºŒç»´ç é¡µé¢</a>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    <script>-->
<!--        let selectedFileType = null;-->

<!--        function selectFileType(type) {-->
<!--            selectedFileType = type;-->

<!--            // æ›´æ–°UI-->
<!--            document.querySelectorAll('.file-type').forEach(el => {-->
<!--                el.classList.remove('selected');-->
<!--            });-->
<!--            event.target.closest('.file-type').classList.add('selected');-->

<!--            // æ›´æ–°æ–‡ä»¶è¾“å…¥æ¡†çš„acceptå±æ€§-->
<!--            const fileInput = document.getElementById('fileInput');-->
<!--            switch(type) {-->
<!--                case 'word':-->
<!--                    fileInput.accept = '.docx';-->
<!--                    break;-->
<!--                case 'ppt':-->
<!--                    fileInput.accept = '.pptx';-->
<!--                    break;-->
<!--                case 'excel':-->
<!--                    fileInput.accept = '.xlsx,.xls';-->
<!--                    break;-->
<!--            }-->
<!--        }-->

<!--        function showStatus(message, isError = false) {-->
<!--            const statusEl = document.getElementById('statusMessage');-->
<!--            statusEl.textContent = message;-->
<!--            statusEl.className = 'status-message ' + (isError ? 'error' : 'success');-->
<!--            statusEl.style.display = 'block';-->

<!--            setTimeout(() => {-->
<!--                statusEl.style.display = 'none';-->
<!--            }, 5000);-->
<!--        }-->

<!--        function showLoading(show = true) {-->
<!--            document.querySelector('.loading').style.display = show ? 'block' : 'none';-->
<!--        }-->

<!--        async function uploadFile() {-->
<!--            if (!selectedFileType) {-->
<!--                showStatus('è¯·å…ˆé€‰æ‹©æ–‡æ¡£ç±»å‹', true);-->
<!--                return;-->
<!--            }-->

<!--            const fileInput = document.getElementById('fileInput');-->
<!--            const file = fileInput.files[0];-->

<!--            if (!file) {-->
<!--                showStatus('è¯·é€‰æ‹©æ–‡ä»¶', true);-->
<!--                return;-->
<!--            }-->

<!--            showLoading(true);-->

<!--            const formData = new FormData();-->
<!--            formData.append('file', file);-->
<!--            formData.append('file_type', selectedFileType);-->

<!--            try {-->
<!--                const response = await fetch('/upload', {-->
<!--                    method: 'POST',-->
<!--                    body: formData-->
<!--                });-->

<!--                const result = await response.json();-->

<!--                if (result.success) {-->
<!--                    showStatus('æ–‡æ¡£ä¸Šä¼ æˆåŠŸï¼');-->

<!--                    // æ›´æ–°äºŒç»´ç æ˜¾ç¤º-->
<!--                    if (result.qr_filename) {-->
<!--                        const qrContainer = document.getElementById('qrContainer');-->
<!--                        let qrHtml = `-->
<!--                            <img src="/static/${result.qr_filename}" alt="ä¼šè¯äºŒç»´ç " class="qr-code">-->
<!--                            <p style="margin-top: 15px; color: #2c3e50;">-->
<!--                                <strong>ğŸ“‹ ä¼šè¯æ¦‚è§ˆ</strong><br>-->
<!--                                ä¼šè¯ID: ${result.session_id}<br>-->
<!--                                <a href="${result.qr_url}" target="_blank">æŸ¥çœ‹æ‰€æœ‰æ–‡æ¡£ â†’</a>-->
<!--                            </p>-->
<!--                        `;-->

<!--                        // æ·»åŠ ç›´æ¥æ–‡æ¡£äºŒç»´ç -->
<!--                        if (result.document_qrs && Object.keys(result.document_qrs).length > 0) {-->
<!--                            qrHtml += `-->
<!--                                <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #f0f0f0;">-->
<!--                                    <p style="color: #2c3e50; margin-bottom: 15px;"><strong>ğŸ¯ ç›´æ¥è®¿é—®æ–‡æ¡£</strong></p>-->
<!--                                    <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">-->
<!--                            `;-->

<!--                            for (const [docType, qrInfo] of Object.entries(result.document_qrs)) {-->
<!--                                const icon = docType === 'word' ? 'ğŸ“' : docType === 'ppt' ? 'ğŸ“Š' : 'ğŸ“ˆ';-->
<!--                                qrHtml += `-->
<!--                                    <div style="text-align: center; min-width: 120px;">-->
<!--                                        <img src="/static/${qrInfo.filename}" alt="${qrInfo.type_name}"-->
<!--                                             style="width: 80px; height: 80px; border-radius: 8px; margin-bottom: 8px;">-->
<!--                                        <div style="font-size: 12px; color: #666;">-->
<!--                                            ${icon} ${qrInfo.type_name}-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                `;-->
<!--                            }-->

<!--                            qrHtml += `-->
<!--                                    </div>-->
<!--                                    <p style="margin-top: 15px; font-size: 13px; color: #666;">-->
<!--                                        <a href="/qr/${result.session_id}" target="_blank">æŸ¥çœ‹æ‰€æœ‰äºŒç»´ç  â†’</a>-->
<!--                                    </p>-->
<!--                                </div>-->
<!--                            `;-->
<!--                        }-->

<!--                        qrContainer.innerHTML = qrHtml;-->
<!--                    }-->

<!--                    // æ¸…ç©ºæ–‡ä»¶è¾“å…¥-->
<!--                    fileInput.value = '';-->
<!--                } else {-->
<!--                    showStatus(result.error || 'ä¸Šä¼ å¤±è´¥', true);-->
<!--                }-->
<!--            } catch (error) {-->
<!--                showStatus('ç½‘ç»œé”™è¯¯ï¼š' + error.message, true);-->
<!--            } finally {-->
<!--                showLoading(false);-->
<!--            }-->
<!--        }-->

<!--        async function newSession() {-->
<!--            try {-->
<!--                const response = await fetch('/new_session');-->
<!--                const result = await response.json();-->
<!--                if (result.success) {-->
<!--                    location.reload();-->
<!--                }-->
<!--            } catch (error) {-->
<!--                showStatus('åˆ›å»ºæ–°ä¼šè¯å¤±è´¥', true);-->
<!--            }-->
<!--        }-->

<!--        // é¡µé¢åŠ è½½æ—¶è·å–å½“å‰äºŒç»´ç ä¿¡æ¯-->
<!--        window.addEventListener('load', async function() {-->
<!--            try {-->
<!--                const response = await fetch('/current_qr');-->
<!--                const result = await response.json();-->

<!--                if (result.has_qr) {-->
<!--                    const qrContainer = document.getElementById('qrContainer');-->
<!--                    let qrHtml = `-->
<!--                        <img src="/static/${result.qr_filename}" alt="ä¼šè¯äºŒç»´ç " class="qr-code">-->
<!--                        <p style="margin-top: 15px; color: #2c3e50;">-->
<!--                            <strong>ğŸ“‹ å½“å‰ä¼šè¯</strong><br>-->
<!--                            ä¼šè¯ID: ${result.session_id}<br>-->
<!--                            å·²ä¸Šä¼  ${result.document_count} ä¸ªæ–‡æ¡£<br>-->
<!--                            <a href="${result.qr_url}" target="_blank">æŸ¥çœ‹æ¦‚è§ˆ â†’</a>-->
<!--                        </p>-->
<!--                    `;-->

<!--                    // æ·»åŠ ç›´æ¥æ–‡æ¡£äºŒç»´ç -->
<!--                    if (result.document_qrs && Object.keys(result.document_qrs).length > 0) {-->
<!--                        qrHtml += `-->
<!--                            <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #f0f0f0;">-->
<!--                                <p style="color: #2c3e50; margin-bottom: 15px;"><strong>ğŸ¯ ç›´æ¥è®¿é—®</strong></p>-->
<!--                                <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">-->
<!--                        `;-->

<!--                        for (const [docType, qrInfo] of Object.entries(result.document_qrs)) {-->
<!--                            const icon = docType === 'word' ? 'ğŸ“' : docType === 'ppt' ? 'ğŸ“Š' : 'ğŸ“ˆ';-->
<!--                            qrHtml += `-->
<!--                                <div style="text-align: center; min-width: 120px;">-->
<!--                                    <img src="/static/${qrInfo.filename}" alt="${qrInfo.type_name}"-->
<!--                                         style="width: 80px; height: 80px; border-radius: 8px; margin-bottom: 8px;">-->
<!--                                    <div style="font-size: 12px; color: #666;">-->
<!--                                        ${icon} ${qrInfo.type_name}-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            `;-->
<!--                        }-->

<!--                        qrHtml += `-->
<!--                                </div>-->
<!--                                <p style="margin-top: 15px; font-size: 13px; color: #666;">-->
<!--                                    <a href="/qr/${result.session_id}" target="_blank">æŸ¥çœ‹å®Œæ•´äºŒç»´ç é¡µé¢ â†’</a>-->
<!--                                </p>-->
<!--                            </div>-->
<!--                        `;-->
<!--                    }-->

<!--                    qrContainer.innerHTML = qrHtml;-->
<!--                }-->
<!--            } catch (error) {-->
<!--                console.log('è·å–äºŒç»´ç ä¿¡æ¯å¤±è´¥:', error);-->
<!--            }-->
<!--        });-->
<!--    </script>-->
<!--</body>-->
<!--</html>-->
<!--<!DOCTYPE html>-->
<!--<html lang="zh-CN">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>æ–‡æ¡£å±•ç¤ºç³»ç»Ÿ</title>-->
<!--    <style>-->
<!--        * {-->
<!--            margin: 0;-->
<!--            padding: 0;-->
<!--            box-sizing: border-box;-->
<!--        }-->

<!--        body {-->
<!--            font-family: 'Arial', sans-serif;-->
<!--            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);-->
<!--            min-height: 100vh;-->
<!--            padding: 20px;-->
<!--        }-->

<!--        .container {-->
<!--            max-width: 1200px;-->
<!--            margin: 0 auto;-->
<!--            background: white;-->
<!--            border-radius: 15px;-->
<!--            box-shadow: 0 20px 40px rgba(0,0,0,0.1);-->
<!--            overflow: hidden;-->
<!--        }-->

<!--        .header {-->
<!--            background: linear-gradient(45deg, #4CAF50, #2196F3);-->
<!--            color: white;-->
<!--            text-align: center;-->
<!--            padding: 40px 20px;-->
<!--            position: relative;-->
<!--        }-->

<!--        .header h1 {-->
<!--            font-size: 2.5em;-->
<!--            margin-bottom: 10px;-->
<!--        }-->

<!--        .header p {-->
<!--            font-size: 1.2em;-->
<!--            opacity: 0.9;-->
<!--        }-->

<!--        .logout-btn {-->
<!--            position: absolute;-->
<!--            top: 20px;-->
<!--            right: 20px;-->
<!--            background: rgba(255,255,255,0.2);-->
<!--            color: white;-->
<!--            border: 2px solid white;-->
<!--            padding: 8px 16px;-->
<!--            border-radius: 20px;-->
<!--            font-size: 14px;-->
<!--            cursor: pointer;-->
<!--            transition: all 0.3s ease;-->
<!--            text-decoration: none;-->
<!--        }-->

<!--        .logout-btn:hover {-->
<!--            background: white;-->
<!--            color: #4CAF50;-->
<!--        }-->

<!--        .main-content {-->
<!--            padding: 40px;-->
<!--        }-->

<!--        .auth-error {-->
<!--            background: #f8d7da;-->
<!--            color: #721c24;-->
<!--            padding: 15px;-->
<!--            border-radius: 10px;-->
<!--            margin: 20px 0;-->
<!--            border: 1px solid #f5c6cb;-->
<!--            text-align: center;-->
<!--        }-->

<!--        .auth-error button {-->
<!--            background: #dc3545;-->
<!--            color: white;-->
<!--            border: none;-->
<!--            padding: 8px 16px;-->
<!--            border-radius: 5px;-->
<!--            cursor: pointer;-->
<!--            margin-left: 10px;-->
<!--        }-->

<!--        .qr-display-section {-->
<!--            margin-bottom: 40px;-->
<!--        }-->

<!--        .qr-result-card {-->
<!--            background: linear-gradient(135deg, #4CAF50 0%, #2196F3 100%);-->
<!--            color: white;-->
<!--            border-radius: 20px;-->
<!--            padding: 30px;-->
<!--            text-align: center;-->
<!--            box-shadow: 0 15px 35px rgba(0,0,0,0.1);-->
<!--        }-->

<!--        .qr-result-card h2 {-->
<!--            margin-bottom: 15px;-->
<!--            font-size: 1.8em;-->
<!--        }-->

<!--        .qr-result-card > p {-->
<!--            margin-bottom: 25px;-->
<!--            font-size: 1.1em;-->
<!--            opacity: 0.9;-->
<!--        }-->

<!--        .qr-image-container {-->
<!--            background: white;-->
<!--            border-radius: 15px;-->
<!--            padding: 20px;-->
<!--            margin: 25px auto;-->
<!--            display: inline-block;-->
<!--            box-shadow: 0 10px 25px rgba(0,0,0,0.2);-->
<!--        }-->

<!--        .qr-image-container img {-->
<!--            max-width: 200px;-->
<!--            height: auto;-->
<!--            border-radius: 8px;-->
<!--        }-->

<!--        .qr-info {-->
<!--            background: rgba(255,255,255,0.1);-->
<!--            border-radius: 12px;-->
<!--            padding: 20px;-->
<!--            margin: 20px 0;-->
<!--            text-align: left;-->
<!--        }-->

<!--        .qr-info p {-->
<!--            margin-bottom: 8px;-->
<!--            font-size: 14px;-->
<!--        }-->

<!--        .qr-info a {-->
<!--            color: #FFE082;-->
<!--            text-decoration: none;-->
<!--            font-weight: bold;-->
<!--        }-->

<!--        .new-session-btn {-->
<!--            background: rgba(255,255,255,0.2);-->
<!--            color: white;-->
<!--            border: 2px solid white;-->
<!--            padding: 12px 25px;-->
<!--            border-radius: 25px;-->
<!--            font-size: 16px;-->
<!--            font-weight: bold;-->
<!--            cursor: pointer;-->
<!--            transition: all 0.3s ease;-->
<!--        }-->

<!--        .new-session-btn:hover {-->
<!--            background: white;-->
<!--            color: #4CAF50;-->
<!--        }-->

<!--        .document-sections {-->
<!--            display: grid;-->
<!--            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));-->
<!--            gap: 30px;-->
<!--            margin-bottom: 40px;-->
<!--        }-->

<!--        .section-card {-->
<!--            background: #f8f9fa;-->
<!--            border-radius: 15px;-->
<!--            padding: 30px;-->
<!--            border: 2px solid #e9ecef;-->
<!--            transition: all 0.3s ease;-->
<!--        }-->

<!--        .section-card:hover {-->
<!--            transform: translateY(-5px);-->
<!--            box-shadow: 0 10px 25px rgba(0,0,0,0.1);-->
<!--        }-->

<!--        .section-card h2 {-->
<!--            color: #333;-->
<!--            margin-bottom: 15px;-->
<!--            font-size: 1.5em;-->
<!--        }-->

<!--        .file-upload {-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .file-input-wrapper {-->
<!--            position: relative;-->
<!--            display: inline-block;-->
<!--            cursor: pointer;-->
<!--            width: 100%;-->
<!--        }-->

<!--        .file-input {-->
<!--            position: absolute;-->
<!--            left: -9999px;-->
<!--        }-->

<!--        .file-input-label {-->
<!--            display: block;-->
<!--            padding: 12px 20px;-->
<!--            background: #007bff;-->
<!--            color: white;-->
<!--            border-radius: 8px;-->
<!--            text-align: center;-->
<!--            transition: background 0.3s;-->
<!--            cursor: pointer;-->
<!--        }-->

<!--        .file-input-label:hover {-->
<!--            background: #0056b3;-->
<!--        }-->

<!--        .upload-btn {-->
<!--            width: 100%;-->
<!--            padding: 12px;-->
<!--            background: #28a745;-->
<!--            color: white;-->
<!--            border: none;-->
<!--            border-radius: 8px;-->
<!--            font-size: 16px;-->
<!--            cursor: pointer;-->
<!--            margin-top: 10px;-->
<!--            transition: background 0.3s;-->
<!--        }-->

<!--        .upload-btn:hover {-->
<!--            background: #218838;-->
<!--        }-->

<!--        .upload-btn:disabled {-->
<!--            background: #6c757d;-->
<!--            cursor: not-allowed;-->
<!--        }-->

<!--        .loading {-->
<!--            display: none;-->
<!--            text-align: center;-->
<!--            color: #007bff;-->
<!--            margin-top: 10px;-->
<!--        }-->

<!--        .file-name {-->
<!--            margin-top: 10px;-->
<!--            font-size: 14px;-->
<!--            color: #666;-->
<!--        }-->

<!--        .error {-->
<!--            color: #dc3545;-->
<!--            margin-top: 10px;-->
<!--        }-->

<!--        .success {-->
<!--            color: #28a745;-->
<!--            margin-top: 10px;-->
<!--        }-->

<!--        .content-display {-->
<!--            margin-top: 20px;-->
<!--            padding: 20px;-->
<!--            background: white;-->
<!--            border-radius: 8px;-->
<!--            border: 1px solid #ddd;-->
<!--            max-height: 400px;-->
<!--            overflow-y: auto;-->
<!--            display: none;-->
<!--        }-->

<!--        .slide-content {-->
<!--            border: 1px solid #ddd;-->
<!--            margin-bottom: 15px;-->
<!--            border-radius: 8px;-->
<!--        }-->

<!--        .slide-header {-->
<!--            background: #f8f9fa;-->
<!--            padding: 10px 15px;-->
<!--            font-weight: bold;-->
<!--            border-bottom: 1px solid #ddd;-->
<!--        }-->

<!--        .slide-body {-->
<!--            padding: 15px;-->
<!--        }-->

<!--        table {-->
<!--            width: 100%;-->
<!--            border-collapse: collapse;-->
<!--        }-->

<!--        table th, table td {-->
<!--            padding: 8px 12px;-->
<!--            text-align: left;-->
<!--            border-bottom: 1px solid #ddd;-->
<!--        }-->

<!--        table th {-->
<!--            background-color: #f8f9fa;-->
<!--            font-weight: bold;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--    <div class="container">-->
<!--        <div class="header">-->
<!--            <a href="/logout" class="logout-btn">ç™»å‡º</a>-->
<!--            <h1>ğŸ“„ æ–‡æ¡£å±•ç¤ºç³»ç»Ÿ</h1>-->
<!--            <p>ä¸Šä¼ å¹¶å±•ç¤ºæ‚¨çš„Wordã€PPTå’ŒExcelæ–‡ä»¶</p>-->
<!--        </div>-->

<!--        <div class="main-content">-->
<!--            &lt;!&ndash; è®¤è¯é”™è¯¯æç¤º &ndash;&gt;-->
<!--            <div id="authError" class="auth-error" style="display: none;">-->
<!--                <p>èº«ä»½éªŒè¯å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•</p>-->
<!--                <button onclick="redirectToLogin()">é‡æ–°ç™»å½•</button>-->
<!--            </div>-->

<!--            &lt;!&ndash; äºŒç»´ç å±•ç¤ºåŒºåŸŸ &ndash;&gt;-->
<!--            <div class="qr-display-section" id="qrSection" style="display: none;">-->
<!--                <div class="qr-result-card">-->
<!--                    <h2>ğŸ“± æ‰«ææŸ¥çœ‹æ–‡æ¡£</h2>-->
<!--                    <p>æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼ä½¿ç”¨æ‰‹æœºæ‰«æä¸‹æ–¹äºŒç»´ç ç›´æ¥æŸ¥çœ‹æ–‡æ¡£å†…å®¹</p>-->
<!--                    <div class="qr-image-container">-->
<!--                        <img id="qrImage" src="" alt="ç”Ÿæˆçš„äºŒç»´ç " />-->
<!--                    </div>-->
<!--                    <div class="qr-info">-->
<!--                        <p><strong>ä¼šè¯ID:</strong> <span id="sessionId"></span></p>-->
<!--                        <p><strong>ç›´æ¥è®¿é—®:</strong> <a id="directLink" href="" target="_blank"></a></p>-->
<!--                        <p><strong>å·²ä¸Šä¼ æ–‡ä»¶:</strong> <span id="fileCount">0</span> ä¸ª</p>-->
<!--                        <p><strong>è®¿é—®å¯†ç :</strong> 123456</p>-->
<!--                    </div>-->
<!--                    <button class="new-session-btn" onclick="createNewSession()">åˆ›å»ºæ–°ä¼šè¯</button>-->
<!--                </div>-->
<!--            </div>-->

<!--            <div class="document-sections">-->
<!--                &lt;!&ndash; Wordæ–‡æ¡£åŒºåŸŸ &ndash;&gt;-->
<!--                <div class="section-card">-->
<!--                    <h2>ğŸ“ Wordæ–‡æ¡£</h2>-->
<!--                    <div class="file-upload">-->
<!--                        <div class="file-input-wrapper">-->
<!--                            <input type="file" id="wordFile" class="file-input" accept=".docx" data-type="word">-->
<!--                            <label for="wordFile" class="file-input-label">é€‰æ‹©Wordæ–‡ä»¶ (.docx)</label>-->
<!--                        </div>-->
<!--                        <div class="file-name" id="wordFileName"></div>-->
<!--                        <button class="upload-btn" onclick="uploadFile('word')" id="wordUploadBtn" disabled>ä¸Šä¼ Wordæ–‡æ¡£</button>-->
<!--                        <div class="loading" id="wordLoading">æ­£åœ¨å¤„ç†æ–‡ä»¶...</div>-->
<!--                        <div class="error" id="wordError"></div>-->
<!--                        <div class="success" id="wordSuccess"></div>-->
<!--                    </div>-->
<!--                    <div class="content-display" id="wordContent"></div>-->
<!--                </div>-->

<!--                &lt;!&ndash; PPTæ¼”ç¤ºæ–‡ç¨¿åŒºåŸŸ &ndash;&gt;-->
<!--                <div class="section-card">-->
<!--                    <h2>ğŸ“Š PPTæ¼”ç¤ºæ–‡ç¨¿</h2>-->
<!--                    <div class="file-upload">-->
<!--                        <div class="file-input-wrapper">-->
<!--                            <input type="file" id="pptFile" class="file-input" accept=".pptx" data-type="ppt">-->
<!--                            <label for="pptFile" class="file-input-label">é€‰æ‹©PPTæ–‡ä»¶ (.pptx)</label>-->
<!--                        </div>-->
<!--                        <div class="file-name" id="pptFileName"></div>-->
<!--                        <button class="upload-btn" onclick="uploadFile('ppt')" id="pptUploadBtn" disabled>ä¸Šä¼ PPTæ–‡æ¡£</button>-->
<!--                        <div class="loading" id="pptLoading">æ­£åœ¨å¤„ç†æ–‡ä»¶...</div>-->
<!--                        <div class="error" id="pptError"></div>-->
<!--                        <div class="success" id="pptSuccess"></div>-->
<!--                    </div>-->
<!--                    <div class="content-display" id="pptContent"></div>-->
<!--                </div>-->

<!--                &lt;!&ndash; Excelè¡¨æ ¼åŒºåŸŸ &ndash;&gt;-->
<!--                <div class="section-card">-->
<!--                    <h2>ğŸ“ˆ Excelè¡¨æ ¼</h2>-->
<!--                    <div class="file-upload">-->
<!--                        <div class="file-input-wrapper">-->
<!--                            <input type="file" id="excelFile" class="file-input" accept=".xlsx,.xls" data-type="excel">-->
<!--                            <label for="excelFile" class="file-input-label">é€‰æ‹©Excelæ–‡ä»¶ (.xlsx/.xls)</label>-->
<!--                        </div>-->
<!--                        <div class="file-name" id="excelFileName"></div>-->
<!--                        <button class="upload-btn" onclick="uploadFile('excel')" id="excelUploadBtn" disabled>ä¸Šä¼ Excelæ–‡æ¡£</button>-->
<!--                        <div class="loading" id="excelLoading">æ­£åœ¨å¤„ç†æ–‡ä»¶...</div>-->
<!--                        <div class="error" id="excelError"></div>-->
<!--                        <div class="success" id="excelSuccess"></div>-->
<!--                    </div>-->
<!--                    <div class="content-display" id="excelContent"></div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    <script>-->
<!--        // å¤„ç†è®¤è¯é”™è¯¯çš„é€šç”¨å‡½æ•°-->
<!--        function handleAuthError(response) {-->
<!--            if (response.status === 401) {-->
<!--                showAuthError();-->
<!--                return true;-->
<!--            }-->
<!--            return false;-->
<!--        }-->

<!--        // æ˜¾ç¤ºè®¤è¯é”™è¯¯-->
<!--        function showAuthError() {-->
<!--            document.getElementById('authError').style.display = 'block';-->
<!--            setTimeout(() => {-->
<!--                redirectToLogin();-->
<!--            }, 3000);-->
<!--        }-->

<!--        // é‡å®šå‘åˆ°ç™»å½•é¡µé¢-->
<!--        function redirectToLogin() {-->
<!--            window.location.href = '/login';-->
<!--        }-->

<!--        // å®‰å…¨çš„fetchè¯·æ±‚åŒ…è£…å™¨-->
<!--        async function safeFetch(url, options = {}) {-->
<!--            try {-->
<!--                const response = await fetch(url, options);-->

<!--                if (handleAuthError(response)) {-->
<!--                    throw new Error('è®¤è¯å¤±è´¥');-->
<!--                }-->

<!--                return response;-->
<!--            } catch (error) {-->
<!--                if (error.message === 'è®¤è¯å¤±è´¥') {-->
<!--                    throw error;-->
<!--                }-->
<!--                throw new Error('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®');-->
<!--            }-->
<!--        }-->

<!--        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥æ˜¯å¦æœ‰å½“å‰ä¼šè¯-->
<!--        window.addEventListener('load', function() {-->
<!--            checkCurrentSession();-->
<!--            initFileInputs();-->
<!--        });-->

<!--        // åˆå§‹åŒ–æ–‡ä»¶è¾“å…¥ç›‘å¬å™¨-->
<!--        function initFileInputs() {-->
<!--            const fileInputs = [-->
<!--                { id: 'wordFile', type: 'word' },-->
<!--                { id: 'pptFile', type: 'ppt' },-->
<!--                { id: 'excelFile', type: 'excel' }-->
<!--            ];-->

<!--            fileInputs.forEach(input => {-->
<!--                const element = document.getElementById(input.id);-->
<!--                element.addEventListener('change', function() {-->
<!--                    handleFileSelection(input.type);-->
<!--                });-->
<!--            });-->
<!--        }-->

<!--        // å¤„ç†æ–‡ä»¶é€‰æ‹©-->
<!--        function handleFileSelection(type) {-->
<!--            const fileInput = document.getElementById(`${type}File`);-->
<!--            const uploadBtn = document.getElementById(`${type}UploadBtn`);-->
<!--            const fileName = document.getElementById(`${type}FileName`);-->
<!--            const errorDiv = document.getElementById(`${type}Error`);-->
<!--            const successDiv = document.getElementById(`${type}Success`);-->

<!--            // æ¸…é™¤ä¹‹å‰çš„æ¶ˆæ¯-->
<!--            errorDiv.textContent = '';-->
<!--            successDiv.textContent = '';-->

<!--            if (fileInput.files.length > 0) {-->
<!--                uploadBtn.disabled = false;-->
<!--                fileName.textContent = `å·²é€‰æ‹©: ${fileInput.files[0].name}`;-->
<!--            } else {-->
<!--                uploadBtn.disabled = true;-->
<!--                fileName.textContent = '';-->
<!--            }-->
<!--        }-->

<!--        // æ£€æŸ¥å½“å‰ä¼šè¯-->
<!--        async function checkCurrentSession() {-->
<!--            try {-->
<!--                const response = await safeFetch('/current_qr');-->
<!--                const data = await response.json();-->

<!--                if (data.has_qr) {-->
<!--                    showGeneratedQR({-->
<!--                        qr_filename: data.qr_filename,-->
<!--                        qr_url: data.qr_url,-->
<!--                        session_id: data.session_id-->
<!--                    });-->
<!--                    document.getElementById('fileCount').textContent = data.document_count;-->
<!--                }-->
<!--            } catch (error) {-->
<!--                if (error.message !== 'è®¤è¯å¤±è´¥') {-->
<!--                    console.log('è·å–ä¼šè¯ä¿¡æ¯å¤±è´¥:', error.message);-->
<!--                }-->
<!--            }-->
<!--        }-->

<!--        // ä¸Šä¼ æ–‡ä»¶å‡½æ•°-->
<!--        async function uploadFile(type) {-->
<!--            const fileInput = document.getElementById(`${type}File`);-->
<!--            const loadingDiv = document.getElementById(`${type}Loading`);-->
<!--            const errorDiv = document.getElementById(`${type}Error`);-->
<!--            const successDiv = document.getElementById(`${type}Success`);-->
<!--            const contentDiv = document.getElementById(`${type}Content`);-->
<!--            const uploadBtn = document.getElementById(`${type}UploadBtn`);-->

<!--            // æ¸…é™¤ä¹‹å‰çš„æ¶ˆæ¯å’Œå†…å®¹-->
<!--            errorDiv.textContent = '';-->
<!--            successDiv.textContent = '';-->
<!--            contentDiv.style.display = 'none';-->

<!--            if (!fileInput.files.length) {-->
<!--                errorDiv.textContent = 'è¯·å…ˆé€‰æ‹©æ–‡ä»¶';-->
<!--                return;-->
<!--            }-->

<!--            const file = fileInput.files[0];-->
<!--            const formData = new FormData();-->
<!--            formData.append('file', file);-->
<!--            formData.append('file_type', type);-->

<!--            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€-->
<!--            loadingDiv.style.display = 'block';-->
<!--            uploadBtn.disabled = true;-->

<!--            try {-->
<!--                const response = await safeFetch('/upload', {-->
<!--                    method: 'POST',-->
<!--                    body: formData-->
<!--                });-->

<!--                const data = await response.json();-->

<!--                if (data.success) {-->
<!--                    successDiv.textContent = 'æ–‡ä»¶ä¸Šä¼ å¹¶å¤„ç†æˆåŠŸï¼';-->
<!--                    displayContent(type, data.content, data.type);-->

<!--                    // æ˜¾ç¤ºç”Ÿæˆçš„äºŒç»´ç -->
<!--                    if (data.qr_url) {-->
<!--                        showGeneratedQR(data);-->
<!--                    }-->
<!--                } else {-->
<!--                    errorDiv.textContent = data.error || 'å¤„ç†æ–‡ä»¶æ—¶å‡ºé”™';-->
<!--                }-->
<!--            } catch (error) {-->
<!--                if (error.message === 'è®¤è¯å¤±è´¥') {-->
<!--                    return;-->
<!--                }-->
<!--                errorDiv.textContent = error.message;-->
<!--            } finally {-->
<!--                loadingDiv.style.display = 'none';-->
<!--                uploadBtn.disabled = false;-->
<!--            }-->
<!--        }-->

<!--        // æ˜¾ç¤ºå†…å®¹å‡½æ•°-->
<!--        function displayContent(type, content, contentType) {-->
<!--            const contentDiv = document.getElementById(`${type}Content`);-->

<!--            if (contentType === 'text') {-->
<!--                contentDiv.innerHTML = `<pre>${content}</pre>`;-->
<!--            } else if (contentType === 'table') {-->
<!--                let html = '';-->
<!--                if (content.error) {-->
<!--                    html = `<p class="error">${content.error}</p>`;-->
<!--                } else {-->
<!--                    for (const [sheetName, tableHtml] of Object.entries(content)) {-->
<!--                        html += `<h3>å·¥ä½œè¡¨: ${sheetName}</h3>${tableHtml}<br>`;-->
<!--                    }-->
<!--                }-->
<!--                contentDiv.innerHTML = html;-->
<!--            } else if (contentType === 'slides') {-->
<!--                let html = '';-->
<!--                if (content[0] && content[0].error) {-->
<!--                    html = `<p class="error">${content[0].error}</p>`;-->
<!--                } else {-->
<!--                    content.forEach(slide => {-->
<!--                        html += `-->
<!--                            <div class="slide-content">-->
<!--                                <div class="slide-header">å¹»ç¯ç‰‡ ${slide.slide_number}</div>-->
<!--                                <div class="slide-body">-->
<!--                                    ${slide.content.map(text => `<p>${text}</p>`).join('')}-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        `;-->
<!--                    });-->
<!--                }-->
<!--                contentDiv.innerHTML = html;-->
<!--            }-->

<!--            contentDiv.style.display = 'block';-->
<!--        }-->

<!--        // æ˜¾ç¤ºç”Ÿæˆçš„äºŒç»´ç -->
<!--        function showGeneratedQR(data) {-->
<!--            const qrSection = document.getElementById('qrSection');-->
<!--            const qrImg = document.getElementById('qrImage');-->
<!--            const sessionIdSpan = document.getElementById('sessionId');-->
<!--            const directLink = document.getElementById('directLink');-->
<!--            const fileCount = document.getElementById('fileCount');-->

<!--            // æ”¯æŒGitHubå­˜å‚¨çš„äºŒç»´ç å›¾ç‰‡URL-->
<!--            qrImg.src = data.qr_github_url || data.qr_filename || `/static/${data.qr_filename}`;-->
<!--            sessionIdSpan.textContent = data.session_id;-->
<!--            directLink.href = data.qr_url;-->
<!--            directLink.textContent = data.qr_url;-->

<!--            // è®¡ç®—ä¸Šä¼ æ–‡ä»¶æ•°é‡-->
<!--            safeFetch('/current_qr')-->
<!--                .then(response => response.json())-->
<!--                .then(result => {-->
<!--                    if (result.has_qr) {-->
<!--                        fileCount.textContent = result.document_count;-->
<!--                    }-->
<!--                })-->
<!--                .catch(error => {-->
<!--                    console.log('æ›´æ–°æ–‡ä»¶è®¡æ•°å¤±è´¥:', error.message);-->
<!--                });-->

<!--            qrSection.style.display = 'block';-->
<!--            qrSection.scrollIntoView({ behavior: 'smooth' });-->
<!--        }-->

<!--        // åˆ›å»ºæ–°ä¼šè¯-->
<!--        async function createNewSession() {-->
<!--            try {-->
<!--                const response = await safeFetch('/new_session');-->
<!--                const data = await response.json();-->

<!--                if (data.success) {-->
<!--                    // éšè—äºŒç»´ç åŒºåŸŸ-->
<!--                    document.getElementById('qrSection').style.display = 'none';-->

<!--                    // æ¸…ç©ºæ‰€æœ‰å†…å®¹æ˜¾ç¤ºåŒºåŸŸ-->
<!--                    ['word', 'ppt', 'excel'].forEach(type => {-->
<!--                        const contentDiv = document.getElementById(`${type}Content`);-->
<!--                        contentDiv.style.display = 'none';-->
<!--                        contentDiv.innerHTML = '';-->

<!--                        // é‡ç½®æ–‡ä»¶è¾“å…¥-->
<!--                        document.getElementById(`${type}File`).value = '';-->
<!--                        document.getElementById(`${type}FileName`).textContent = '';-->
<!--                        document.getElementById(`${type}UploadBtn`).disabled = true;-->

<!--                        // æ¸…é™¤çŠ¶æ€æ¶ˆæ¯-->
<!--                        document.getElementById(`${type}Error`).textContent = '';-->
<!--                        document.getElementById(`${type}Success`).textContent = '';-->
<!--                    });-->

<!--                    alert('æ–°ä¼šè¯å·²åˆ›å»ºï¼ç°åœ¨å¯ä»¥ä¸Šä¼ æ–°çš„æ–‡ä»¶ã€‚');-->
<!--                }-->
<!--            } catch (error) {-->
<!--                if (error.message === 'è®¤è¯å¤±è´¥') {-->
<!--                    return;-->
<!--                }-->
<!--                alert('åˆ›å»ºæ–°ä¼šè¯å¤±è´¥: ' + error.message);-->
<!--            }-->
<!--        }-->

<!--        // é¡µé¢å¯è§æ€§æ£€æŸ¥-->
<!--        document.addEventListener('visibilitychange', function() {-->
<!--            if (!document.hidden) {-->
<!--                checkCurrentSession();-->
<!--            }-->
<!--        });-->
<!--    </script>-->
<!--</body>-->
<!--</html>-->