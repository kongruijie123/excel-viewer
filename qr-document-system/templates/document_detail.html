<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡æ¡£è¯¦æƒ…æŸ¥çœ‹å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .header {
            background: linear-gradient(45deg, #4CAF50, #2196F3);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            animation: shimmer 3s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { transform: translateX(-100%) rotate(45deg); }
            50% { transform: translateX(100%) rotate(45deg); }
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }

        .header p {
            position: relative;
            z-index: 1;
            opacity: 0.9;
        }

        .nav-bar {
            background: rgba(248, 249, 250, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 40px;
            border-bottom: 1px solid rgba(221, 221, 221, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-btn {
            padding: 12px 24px;
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,123,255,0.3);
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,123,255,0.4);
        }

        .content {
            padding: 40px;
        }

        /* æ–‡æ¡£ç±»å‹é€‰æ‹©å™¨ */
        .doc-type-selector {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 10px;
        }

        .doc-type-btn {
            padding: 12px 24px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            color: #6c757d;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .doc-type-btn.active {
            background: linear-gradient(45deg, #4CAF50, #2196F3);
            color: white;
            border-color: transparent;
            transform: scale(1.05);
        }

        .doc-type-btn:hover:not(.active) {
            background: #e9ecef;
            transform: translateY(-2px);
        }

        /* Wordæ ·å¼ */
        .word-section {
            display: none;
        }

        .word-section.active {
            display: block;
        }

        .font-controls {
            margin-bottom: 30px;
            text-align: center;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 15px;
        }

        .font-btn {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 0 10px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,123,255,0.2);
        }

        .font-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,123,255,0.3);
        }

        .font-size-display {
            display: inline-block;
            margin: 0 15px;
            font-weight: bold;
            font-size: 16px;
            color: #495057;
        }

        .word-content {
            line-height: 1.8;
            font-size: 16px;
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            border-left: 4px solid #4CAF50;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.05);
        }

        /* PPTæ ·å¼ */
        .ppt-section {
            display: none;
        }

        .ppt-section.active {
            display: block;
        }

        .ppt-controls {
            text-align: center;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 15px;
        }

        .ppt-controls button {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 0 10px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(40,167,69,0.2);
        }

        .ppt-controls button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(40,167,69,0.3);
        }

        .ppt-controls button:disabled {
            background: linear-gradient(45deg, #6c757d, #5a6268);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .slide-counter {
            margin: 0 20px;
            font-weight: bold;
            color: #495057;
            font-size: 18px;
        }

        .slide {
            display: none;
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            padding: 40px;
            border-radius: 15px;
            margin: 20px 0;
            min-height: 500px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(0,0,0,0.05);
        }

        .slide.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .slide h2 {
            color: #2c3e50;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #4CAF50;
            font-size: 1.8em;
        }

        .slide p {
            margin-bottom: 20px;
            line-height: 1.8;
            color: #495057;
            font-size: 16px;
        }

        /* Excelæ ·å¼ */
        .excel-section {
            display: none;
        }

        .excel-section.active {
            display: block;
        }

        .excel-controls {
            margin-bottom: 30px;
            text-align: center;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 15px;
        }

        .sheet-btn {
            background: linear-gradient(45deg, #ffc107, #ff9800);
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 0 8px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255,193,7,0.2);
        }

        .sheet-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255,193,7,0.3);
        }

        .sheet-btn.active {
            background: linear-gradient(45deg, #007bff, #0056b3);
            transform: scale(1.05);
        }

        .sheet {
            display: none;
            overflow-x: auto;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .sheet.active {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            background: white;
        }

        table th, table td {
            padding: 12px 15px;
            text-align: left;
            border: 1px solid #dee2e6;
        }

        table th {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        table tr:hover {
            background-color: #e3f2fd;
            transition: background-color 0.3s ease;
        }

        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            line-height: 1.6;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            border-left: 4px solid #007bff;
            font-family: 'Consolas', 'Monaco', monospace;
        }

        .error {
            color: #dc3545;
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #ffe6e6, #ffcccc);
            border-radius: 15px;
            border: 2px solid #ff6b6b;
        }

        .demo-content {
            text-align: center;
            color: #6c757d;
            padding: 40px;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="header-title">ğŸ“„ æ–‡æ¡£æŸ¥çœ‹å™¨</h1>
            <p id="header-subtitle">æ”¯æŒWordã€PPTã€Excelå¤šç§æ ¼å¼</p>
            <p style="font-size: 14px; opacity: 0.9;">æ¼”ç¤ºç‰ˆæœ¬ - 2025</p>
        </div>

        <div class="nav-bar">
            <span>æ–‡æ¡£ç®¡ç†ç³»ç»Ÿ</span>
            <div>
                <a href="#" class="nav-btn" onclick="resetDemo()">ğŸ”„ é‡ç½®</a>
                <a href="#" class="nav-btn">ğŸ  ä¸»é¡µ</a>
            </div>
        </div>

        <div class="content">
            <!-- æ–‡æ¡£ç±»å‹é€‰æ‹©å™¨ -->
            <div class="doc-type-selector">
                <button class="doc-type-btn active" onclick="showDocType('word')">ğŸ“ Wordæ–‡æ¡£</button>
                <button class="doc-type-btn" onclick="showDocType('ppt')">ğŸ“Š PPTæ¼”ç¤ºæ–‡ç¨¿</button>
                <button class="doc-type-btn" onclick="showDocType('excel')">ğŸ“ˆ Excelè¡¨æ ¼</button>
            </div>

            <!-- Wordæ–‡æ¡£éƒ¨åˆ† -->
            <div class="word-section active" id="word-section">
                <div class="font-controls">
                    <button class="font-btn" onclick="changeFontSize(-2)">å­—ä½“ A-</button>
                    <span class="font-size-display" id="font-size">16px</span>
                    <button class="font-btn" onclick="changeFontSize(2)">å­—ä½“ A+</button>
                    <button class="font-btn" onclick="resetFontSize()">é‡ç½®</button>
                </div>
                <div class="word-content" id="word-content">
                    <pre>è¿™æ˜¯ä¸€ä¸ªWordæ–‡æ¡£çš„ç¤ºä¾‹å†…å®¹ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨ä¸Šé¢çš„æŒ‰é’®æ¥è°ƒæ•´å­—ä½“å¤§å°ã€‚

è¿™ä¸ªæ¼”ç¤ºå±•ç¤ºäº†å¦‚ä½•åœ¨ç½‘é¡µä¸­æ˜¾ç¤ºå’Œæ§åˆ¶Wordæ–‡æ¡£çš„æ˜¾ç¤ºæ•ˆæœã€‚

æ–‡æ¡£å†…å®¹æ”¯æŒï¼š
â€¢ å­—ä½“å¤§å°è°ƒæ•´
â€¢ æ ¼å¼ä¿æŒ
â€¢ å“åº”å¼æ˜¾ç¤º

è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„æ–‡æ¡£æŸ¥çœ‹å™¨ç¤ºä¾‹ã€‚</pre>
                </div>
            </div>

            <!-- PPTæ¼”ç¤ºæ–‡ç¨¿éƒ¨åˆ† -->
            <div class="ppt-section" id="ppt-section">
                <div class="ppt-controls">
                    <button onclick="prevSlide()" id="prev-btn">â† ä¸Šä¸€å¼ </button>
                    <span class="slide-counter" id="slide-counter">1 / 4</span>
                    <button onclick="nextSlide()" id="next-btn">ä¸‹ä¸€å¼  â†’</button>
                </div>

                <div class="slide active" id="slide-1">
                    <h2>å¹»ç¯ç‰‡ 1 - æ¬¢è¿</h2>
                    <p>æ¬¢è¿ä½¿ç”¨PPTæŸ¥çœ‹å™¨</p>
                    <p>è¿™æ˜¯ç¬¬ä¸€å¼ å¹»ç¯ç‰‡ï¼Œå±•ç¤ºäº†åŸºæœ¬çš„åŠŸèƒ½ã€‚</p>
                    <p>æ‚¨å¯ä»¥ä½¿ç”¨æŒ‰é’®æˆ–é”®ç›˜å·¦å³ç®­å¤´é”®æ¥å¯¼èˆªã€‚</p>
                </div>

                <div class="slide" id="slide-2">
                    <h2>å¹»ç¯ç‰‡ 2 - åŠŸèƒ½ç‰¹ç‚¹</h2>
                    <p>ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
                    <p>â€¢ æµç•…çš„å¹»ç¯ç‰‡åˆ‡æ¢åŠ¨ç”»</p>
                    <p>â€¢ é”®ç›˜å¯¼èˆªæ”¯æŒ</p>
                    <p>â€¢ å“åº”å¼è®¾è®¡</p>
                    <p>â€¢ ç°ä»£åŒ–çš„ç”¨æˆ·ç•Œé¢</p>
                </div>

                <div class="slide" id="slide-3">
                    <h2>å¹»ç¯ç‰‡ 3 - æŠ€æœ¯ç‰¹è‰²</h2>
                    <p>æŠ€æœ¯å®ç°ï¼š</p>
                    <p>â€¢ çº¯HTML/CSS/JavaScript</p>
                    <p>â€¢ æ— éœ€å¤–éƒ¨ä¾èµ–</p>
                    <p>â€¢ ç°ä»£æµè§ˆå™¨å…¼å®¹</p>
                    <p>â€¢ ç§»åŠ¨è®¾å¤‡å‹å¥½</p>
                </div>

                <div class="slide" id="slide-4">
                    <h2>å¹»ç¯ç‰‡ 4 - æ€»ç»“</h2>
                    <p>æ„Ÿè°¢æ‚¨çš„æŸ¥çœ‹ï¼</p>
                    <p>è¿™ä¸ªæ¼”ç¤ºå±•ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„PPTæŸ¥çœ‹å™¨ã€‚</p>
                    <p>æ‰€æœ‰åŠŸèƒ½éƒ½å·²æ­£å¸¸å·¥ä½œï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p>
                </div>
            </div>

            <!-- Excelè¡¨æ ¼éƒ¨åˆ† -->
            <div class="excel-section" id="excel-section">
                <div class="excel-controls">
                    <button class="sheet-btn active" onclick="showSheet(1, this)">é”€å”®æ•°æ®</button>
                    <button class="sheet-btn" onclick="showSheet(2, this)">è´¢åŠ¡æŠ¥è¡¨</button>
                    <button class="sheet-btn" onclick="showSheet(3, this)">å‘˜å·¥ä¿¡æ¯</button>
                </div>

                <div class="sheet active" id="sheet-1">
                    <table>
                        <thead>
                            <tr>
                                <th>æ—¥æœŸ</th>
                                <th>äº§å“</th>
                                <th>é”€å”®é¢</th>
                                <th>æ•°é‡</th>
                                <th>å®¢æˆ·</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>2025-08-01</td>
                                <td>ç¬”è®°æœ¬ç”µè„‘</td>
                                <td>Â¥8,999</td>
                                <td>1</td>
                                <td>å¼ ä¸‰</td>
                            </tr>
                            <tr>
                                <td>2025-08-02</td>
                                <td>é¼ æ ‡</td>
                                <td>Â¥199</td>
                                <td>5</td>
                                <td>æå››</td>
                            </tr>
                            <tr>
                                <td>2025-08-03</td>
                                <td>é”®ç›˜</td>
                                <td>Â¥599</td>
                                <td>2</td>
                                <td>ç‹äº”</td>
                            </tr>
                            <tr>
                                <td>2025-08-04</td>
                                <td>æ˜¾ç¤ºå™¨</td>
                                <td>Â¥2,999</td>
                                <td>1</td>
                                <td>èµµå…­</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="sheet" id="sheet-2">
                    <table>
                        <thead>
                            <tr>
                                <th>é¡¹ç›®</th>
                                <th>Q1</th>
                                <th>Q2</th>
                                <th>Q3</th>
                                <th>Q4</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>æ”¶å…¥</td>
                                <td>Â¥120,000</td>
                                <td>Â¥135,000</td>
                                <td>Â¥145,000</td>
                                <td>Â¥160,000</td>
                            </tr>
                            <tr>
                                <td>æ”¯å‡º</td>
                                <td>Â¥85,000</td>
                                <td>Â¥92,000</td>
                                <td>Â¥98,000</td>
                                <td>Â¥105,000</td>
                            </tr>
                            <tr>
                                <td>åˆ©æ¶¦</td>
                                <td>Â¥35,000</td>
                                <td>Â¥43,000</td>
                                <td>Â¥47,000</td>
                                <td>Â¥55,000</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="sheet" id="sheet-3">
                    <table>
                        <thead>
                            <tr>
                                <th>å§“å</th>
                                <th>éƒ¨é—¨</th>
                                <th>èŒä½</th>
                                <th>å…¥èŒæ—¶é—´</th>
                                <th>è–ªèµ„</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>å¼ å°æ˜</td>
                                <td>æŠ€æœ¯éƒ¨</td>
                                <td>é«˜çº§å·¥ç¨‹å¸ˆ</td>
                                <td>2023-03-15</td>
                                <td>Â¥18,000</td>
                            </tr>
                            <tr>
                                <td>æå°çº¢</td>
                                <td>é”€å”®éƒ¨</td>
                                <td>é”€å”®ç»ç†</td>
                                <td>2022-08-20</td>
                                <td>Â¥15,000</td>
                            </tr>
                            <tr>
                                <td>ç‹å°å</td>
                                <td>å¸‚åœºéƒ¨</td>
                                <td>å¸‚åœºä¸“å‘˜</td>
                                <td>2024-01-10</td>
                                <td>Â¥12,000</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentFontSize = 16;
        let currentSlide = 1;
        const totalSlides = 4;

        // æ–‡æ¡£ç±»å‹åˆ‡æ¢
        function showDocType(type) {
            // éšè—æ‰€æœ‰éƒ¨åˆ†
            document.querySelectorAll('.word-section, .ppt-section, .excel-section').forEach(section => {
                section.classList.remove('active');
            });

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.doc-type-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // æ˜¾ç¤ºé€‰ä¸­çš„éƒ¨åˆ†
            const section = document.getElementById(type + '-section');
            const button = event.target;

            if (section) {
                section.classList.add('active');
            }

            if (button) {
                button.classList.add('active');
            }

            // æ›´æ–°æ ‡é¢˜
            const titles = {
                'word': 'ğŸ“ Wordæ–‡æ¡£',
                'ppt': 'ğŸ“Š PPTæ¼”ç¤ºæ–‡ç¨¿',
                'excel': 'ğŸ“ˆ Excelè¡¨æ ¼'
            };

            const headerTitle = document.getElementById('header-title');
            if (headerTitle && titles[type]) {
                headerTitle.textContent = titles[type];
            }
        }

        // Wordå­—ä½“æ§åˆ¶
        function changeFontSize(delta) {
            currentFontSize += delta;
            if (currentFontSize < 12) currentFontSize = 12;
            if (currentFontSize > 32) currentFontSize = 32;

            updateFontSize();
        }

        function resetFontSize() {
            currentFontSize = 16;
            updateFontSize();
        }

        function updateFontSize() {
            const content = document.getElementById('word-content');
            const display = document.getElementById('font-size');

            if (content) {
                content.style.fontSize = currentFontSize + 'px';
            }
            if (display) {
                display.textContent = currentFontSize + 'px';
            }
        }

        // PPTæ§åˆ¶
        function showSlide(slideNum) {
            if (slideNum < 1 || slideNum > totalSlides) return;

            // éšè—æ‰€æœ‰å¹»ç¯ç‰‡
            document.querySelectorAll('.slide').forEach(slide => {
                slide.classList.remove('active');
            });

            // æ˜¾ç¤ºå½“å‰å¹»ç¯ç‰‡
            const slide = document.getElementById('slide-' + slideNum);
            if (slide) {
                slide.classList.add('active');
            }

            // æ›´æ–°è®¡æ•°å™¨
            const counter = document.getElementById('slide-counter');
            if (counter) {
                counter.textContent = slideNum + ' / ' + totalSlides;
            }

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            if (prevBtn) prevBtn.disabled = (slideNum === 1);
            if (nextBtn) nextBtn.disabled = (slideNum === totalSlides);

            currentSlide = slideNum;
        }

        function prevSlide() {
            if (currentSlide > 1) {
                showSlide(currentSlide - 1);
            }
        }

        function nextSlide() {
            if (currentSlide < totalSlides) {
                showSlide(currentSlide + 1);
            }
        }

        // Excelå·¥ä½œè¡¨åˆ‡æ¢
        function showSheet(sheetNum, clickedBtn) {
            // éšè—æ‰€æœ‰å·¥ä½œè¡¨
            document.querySelectorAll('.sheet').forEach(sheet => {
                sheet.classList.remove('active');
            });

            // æ˜¾ç¤ºé€‰ä¸­çš„å·¥ä½œè¡¨
            const sheet = document.getElementById('sheet-' + sheetNum);
            if (sheet) {
                sheet.classList.add('active');
            }

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.sheet-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            if (clickedBtn) {
                clickedBtn.classList.add('active');
            }
        }

        // é”®ç›˜äº‹ä»¶
        document.addEventListener('keydown', function(event) {
            // åªåœ¨PPTéƒ¨åˆ†æ¿€æ´»æ—¶å¤„ç†é”®ç›˜äº‹ä»¶
            const pptSection = document.getElementById('ppt-section');
            if (pptSection && pptSection.classList.contains('active')) {
                if (event.key === 'ArrowLeft') {
                    event.preventDefault();
                    prevSlide();
                } else if (event.key === 'ArrowRight') {
                    event.preventDefault();
                    nextSlide();
                }
            }
        });

        // é‡ç½®æ¼”ç¤º
        function resetDemo() {
            // é‡ç½®åˆ°Wordæ–‡æ¡£
            showDocType('word');

            // é‡ç½®å­—ä½“å¤§å°
            resetFontSize();

            // é‡ç½®PPTåˆ°ç¬¬ä¸€å¼ 
            showSlide(1);

            // é‡ç½®Excelåˆ°ç¬¬ä¸€ä¸ªè¡¨æ ¼
            const firstSheetBtn = document.querySelector('.sheet-btn');
            if (firstSheetBtn) {
                showSheet(1, firstSheetBtn);
            }
        }

        // åˆå§‹åŒ–
        window.addEventListener('load', function() {
            // åˆå§‹åŒ–PPT
            showSlide(1);

            // åˆå§‹åŒ–å­—ä½“å¤§å°
            updateFontSize();

            console.log('æ–‡æ¡£æŸ¥çœ‹å™¨å·²åŠ è½½å®Œæˆ');
        });
    </script>
</body>
</html>

<!--<!DOCTYPE html>-->
<!--<html lang="zh-CN">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>{{ doc_data.filename }} - OfficeæŸ¥çœ‹å™¨</title>-->
<!--    <style>-->
<!--        * {-->
<!--            margin: 0;-->
<!--            padding: 0;-->
<!--            box-sizing: border-box;-->
<!--        }-->

<!--        body {-->
<!--            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;-->
<!--            background: #f3f2f1;-->
<!--            min-height: 100vh;-->
<!--        }-->

<!--        /* Officeé£æ ¼é¡¶æ  */-->
<!--        .office-header {-->
<!--            background: #0078d4;-->
<!--            color: white;-->
<!--            padding: 12px 20px;-->
<!--            display: flex;-->
<!--            justify-content: space-between;-->
<!--            align-items: center;-->
<!--            box-shadow: 0 2px 4px rgba(0,0,0,0.1);-->
<!--        }-->

<!--        .office-title {-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            gap: 12px;-->
<!--        }-->

<!--        .office-icon {-->
<!--            font-size: 1.5em;-->
<!--        }-->

<!--        .file-info h1 {-->
<!--            font-size: 1.2em;-->
<!--            font-weight: 600;-->
<!--        }-->

<!--        .file-info p {-->
<!--            font-size: 0.85em;-->
<!--            opacity: 0.9;-->
<!--        }-->

<!--        .header-actions {-->
<!--            display: flex;-->
<!--            gap: 10px;-->
<!--        }-->

<!--        .header-btn {-->
<!--            padding: 8px 16px;-->
<!--            background: rgba(255,255,255,0.2);-->
<!--            color: white;-->
<!--            text-decoration: none;-->
<!--            border-radius: 4px;-->
<!--            font-size: 0.9em;-->
<!--            transition: background 0.2s;-->
<!--        }-->

<!--        .header-btn:hover {-->
<!--            background: rgba(255,255,255,0.3);-->
<!--        }-->

<!--        /* Officeé£æ ¼å·¥å…·æ  */-->
<!--        .office-toolbar {-->
<!--            background: #faf9f8;-->
<!--            border-bottom: 1px solid #edebe9;-->
<!--            padding: 8px 20px;-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            gap: 15px;-->
<!--            flex-wrap: wrap;-->
<!--        }-->

<!--        .toolbar-group {-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            gap: 8px;-->
<!--            padding: 0 12px;-->
<!--            border-right: 1px solid #edebe9;-->
<!--        }-->

<!--        .toolbar-group:last-child {-->
<!--            border-right: none;-->
<!--        }-->

<!--        .toolbar-btn {-->
<!--            padding: 6px 12px;-->
<!--            border: 1px solid transparent;-->
<!--            border-radius: 3px;-->
<!--            background: none;-->
<!--            cursor: pointer;-->
<!--            font-size: 0.9em;-->
<!--            transition: all 0.2s;-->
<!--        }-->

<!--        .toolbar-btn:hover {-->
<!--            background: #e1dfdd;-->
<!--            border-color: #c8c6c4;-->
<!--        }-->

<!--        .toolbar-btn.active {-->
<!--            background: #0078d4;-->
<!--            color: white;-->
<!--            border-color: #0078d4;-->
<!--        }-->

<!--        /* ä¸»è¦å†…å®¹åŒºåŸŸ */-->
<!--        .office-content {-->
<!--            height: calc(100vh - 120px);-->
<!--            overflow: hidden;-->
<!--            display: flex;-->
<!--        }-->

<!--        /* æ–‡æ¡£æŸ¥çœ‹åŒºåŸŸ */-->
<!--        .document-viewer {-->
<!--            flex: 1;-->
<!--            background: white;-->
<!--            overflow: auto;-->
<!--            position: relative;-->
<!--        }-->

<!--        /* ======================-->
<!--           Wordæ–‡æ¡£æ ·å¼-->
<!--        ====================== */-->
<!--        .word-page {-->
<!--            max-width: 800px;-->
<!--            margin: 40px auto;-->
<!--            background: white;-->
<!--            box-shadow: 0 4px 12px rgba(0,0,0,0.1);-->
<!--            border-radius: 6px;-->
<!--            overflow: hidden;-->
<!--        }-->

<!--        .word-content {-->
<!--            padding: 50px 60px;-->
<!--            line-height: 1.8;-->
<!--            font-size: 14px;-->
<!--            color: #323130;-->
<!--            font-family: 'Times New Roman', serif;-->
<!--            min-height: 800px;-->
<!--        }-->

<!--        .word-content pre {-->
<!--            white-space: pre-wrap;-->
<!--            word-wrap: break-word;-->
<!--            font-family: 'Times New Roman', serif;-->
<!--            line-height: inherit;-->
<!--        }-->

<!--        /* ======================-->
<!--           PPTæ¼”ç¤ºæ–‡ç¨¿æ ·å¼-->
<!--        ====================== */-->
<!--        .ppt-viewer {-->
<!--            height: 100%;-->
<!--            display: flex;-->
<!--            flex-direction: column;-->
<!--        }-->

<!--        .slide-navigation {-->
<!--            background: #faf9f8;-->
<!--            padding: 12px 20px;-->
<!--            border-bottom: 1px solid #edebe9;-->
<!--            display: flex;-->
<!--            justify-content: center;-->
<!--            align-items: center;-->
<!--            gap: 20px;-->
<!--        }-->

<!--        .nav-button {-->
<!--            padding: 8px 16px;-->
<!--            border: 1px solid #c8c6c4;-->
<!--            border-radius: 3px;-->
<!--            background: white;-->
<!--            cursor: pointer;-->
<!--            font-size: 0.9em;-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            gap: 6px;-->
<!--        }-->

<!--        .nav-button:hover:not(:disabled) {-->
<!--            background: #f3f2f1;-->
<!--            border-color: #a19f9d;-->
<!--        }-->

<!--        .nav-button:disabled {-->
<!--            opacity: 0.5;-->
<!--            cursor: not-allowed;-->
<!--        }-->

<!--        .slide-counter {-->
<!--            font-weight: 600;-->
<!--            color: #323130;-->
<!--            font-size: 0.95em;-->
<!--        }-->

<!--        .slide-container {-->
<!--            flex: 1;-->
<!--            display: flex;-->
<!--            justify-content: center;-->
<!--            align-items: center;-->
<!--            padding: 20px;-->
<!--            background: #f3f2f1;-->
<!--        }-->

<!--        .slide {-->
<!--            width: 90%;-->
<!--            max-width: 900px;-->
<!--            aspect-ratio: 16/9;-->
<!--            background: white;-->
<!--            border-radius: 8px;-->
<!--            box-shadow: 0 8px 24px rgba(0,0,0,0.15);-->
<!--            padding: 40px;-->
<!--            display: none;-->
<!--            overflow-y: auto;-->
<!--        }-->

<!--        .slide.active {-->
<!--            display: block;-->
<!--            animation: slideInFade 0.4s ease-out;-->
<!--        }-->

<!--        @keyframes slideInFade {-->
<!--            from { opacity: 0; transform: translateX(20px); }-->
<!--            to { opacity: 1; transform: translateX(0); }-->
<!--        }-->

<!--        .slide h2 {-->
<!--            color: #0078d4;-->
<!--            font-size: 2em;-->
<!--            margin-bottom: 30px;-->
<!--            border-bottom: 3px solid #0078d4;-->
<!--            padding-bottom: 10px;-->
<!--        }-->

<!--        .slide p {-->
<!--            font-size: 1.1em;-->
<!--            line-height: 1.6;-->
<!--            margin-bottom: 20px;-->
<!--            color: #323130;-->
<!--        }-->

<!--        /* ======================-->
<!--           Excelè¡¨æ ¼æ ·å¼-->
<!--        ====================== */-->
<!--        .excel-viewer {-->
<!--            height: 100%;-->
<!--            display: flex;-->
<!--            flex-direction: column;-->
<!--        }-->

<!--        .sheet-tabs {-->
<!--            background: #faf9f8;-->
<!--            border-bottom: 1px solid #edebe9;-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            padding: 0 20px;-->
<!--            overflow-x: auto;-->
<!--        }-->

<!--        .sheet-tab {-->
<!--            padding: 10px 20px;-->
<!--            border: none;-->
<!--            background: none;-->
<!--            cursor: pointer;-->
<!--            font-size: 0.9em;-->
<!--            color: #605e5c;-->
<!--            border-bottom: 3px solid transparent;-->
<!--            white-space: nowrap;-->
<!--            transition: all 0.2s;-->
<!--        }-->

<!--        .sheet-tab:hover {-->
<!--            background: #f3f2f1;-->
<!--        }-->

<!--        .sheet-tab.active {-->
<!--            color: #0078d4;-->
<!--            border-bottom-color: #0078d4;-->
<!--            background: white;-->
<!--        }-->

<!--        .excel-content {-->
<!--            flex: 1;-->
<!--            overflow: auto;-->
<!--            background: white;-->
<!--        }-->

<!--        .excel-sheet {-->
<!--            display: none;-->
<!--            height: 100%;-->
<!--        }-->

<!--        .excel-sheet.active {-->
<!--            display: block;-->
<!--        }-->

<!--        .excel-table {-->
<!--            width: 100%;-->
<!--            border-collapse: collapse;-->
<!--            font-size: 13px;-->
<!--            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;-->
<!--        }-->

<!--        .excel-table th {-->
<!--            background: #f8f8f8;-->
<!--            color: #323130;-->
<!--            font-weight: 600;-->
<!--            padding: 10px 12px;-->
<!--            border: 1px solid #d2d0ce;-->
<!--            text-align: left;-->
<!--            position: sticky;-->
<!--            top: 0;-->
<!--            z-index: 10;-->
<!--        }-->

<!--        .excel-table th:first-child {-->
<!--            background: #0078d4;-->
<!--            color: white;-->
<!--            text-align: center;-->
<!--            min-width: 50px;-->
<!--        }-->

<!--        .excel-table td {-->
<!--            padding: 8px 12px;-->
<!--            border: 1px solid #edebe9;-->
<!--            vertical-align: top;-->
<!--            transition: background 0.1s;-->
<!--        }-->

<!--        .excel-table td:first-child {-->
<!--            background: #f8f8f8;-->
<!--            font-weight: 600;-->
<!--            text-align: center;-->
<!--            color: #605e5c;-->
<!--        }-->

<!--        .excel-table tbody tr:nth-child(even) td:not(:first-child) {-->
<!--            background: #fafafa;-->
<!--        }-->

<!--        .excel-table tbody tr:hover td {-->
<!--            background: #e1dfdd !important;-->
<!--        }-->

<!--        .excel-table tbody tr:hover td:first-child {-->
<!--            background: #d2d0ce !important;-->
<!--        }-->

<!--        /* æ•°æ®ç±»å‹æ ·å¼ */-->
<!--        .cell-number {-->
<!--            text-align: right;-->
<!--            color: #0078d4;-->
<!--            font-weight: 500;-->
<!--        }-->

<!--        .cell-date {-->
<!--            color: #107c10;-->
<!--        }-->

<!--        .cell-formula {-->
<!--            color: #8764b8;-->
<!--            font-style: italic;-->
<!--        }-->

<!--        /* ç©ºçŠ¶æ€ */-->
<!--        .empty-state {-->
<!--            display: flex;-->
<!--            flex-direction: column;-->
<!--            align-items: center;-->
<!--            justify-content: center;-->
<!--            height: 400px;-->
<!--            color: #605e5c;-->
<!--        }-->

<!--        .empty-icon {-->
<!--            font-size: 4em;-->
<!--            margin-bottom: 20px;-->
<!--            opacity: 0.5;-->
<!--        }-->

<!--        .error-state {-->
<!--            background: #fde7e9;-->
<!--            color: #a4262c;-->
<!--            padding: 20px;-->
<!--            border-radius: 4px;-->
<!--            margin: 20px;-->
<!--            border: 1px solid #f1b5bb;-->
<!--        }-->

<!--        /* å“åº”å¼è®¾è®¡ */-->
<!--        @media (max-width: 768px) {-->
<!--            .office-header {-->
<!--                padding: 8px 15px;-->
<!--                flex-direction: column;-->
<!--                gap: 10px;-->
<!--            }-->

<!--            .office-toolbar {-->
<!--                padding: 8px 15px;-->
<!--                flex-wrap: wrap;-->
<!--            }-->

<!--            .office-content {-->
<!--                height: calc(100vh - 140px);-->
<!--            }-->

<!--            .word-content {-->
<!--                padding: 30px 20px;-->
<!--                font-size: 13px;-->
<!--            }-->

<!--            .slide-container {-->
<!--                padding: 10px;-->
<!--            }-->

<!--            .slide {-->
<!--                width: 95%;-->
<!--                padding: 20px;-->
<!--            }-->

<!--            .slide h2 {-->
<!--                font-size: 1.5em;-->
<!--            }-->

<!--            .excel-table {-->
<!--                font-size: 12px;-->
<!--            }-->

<!--            .excel-table th,-->
<!--            .excel-table td {-->
<!--                padding: 6px 8px;-->
<!--            }-->
<!--        }-->

<!--        /* åŠ è½½åŠ¨ç”» */-->
<!--        .loading {-->
<!--            display: flex;-->
<!--            justify-content: center;-->
<!--            align-items: center;-->
<!--            height: 300px;-->
<!--            color: #605e5c;-->
<!--        }-->

<!--        .spinner {-->
<!--            width: 32px;-->
<!--            height: 32px;-->
<!--            border: 3px solid #f3f2f1;-->
<!--            border-top: 3px solid #0078d4;-->
<!--            border-radius: 50%;-->
<!--            animation: spin 1s linear infinite;-->
<!--            margin-right: 15px;-->
<!--        }-->

<!--        @keyframes spin {-->
<!--            0% { transform: rotate(0deg); }-->
<!--            100% { transform: rotate(360deg); }-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--    &lt;!&ndash; Officeé£æ ¼é¡¶æ  &ndash;&gt;-->
<!--    <div class="office-header">-->
<!--        <div class="office-title">-->
<!--            <div class="office-icon">-->
<!--                {% if doc_type == 'word' %}ğŸ“-->
<!--                {% elif doc_type == 'ppt' %}ğŸ“Š-->
<!--                {% elif doc_type == 'excel' %}ğŸ“ˆ-->
<!--                {% else %}ğŸ“„-->
<!--                {% endif %}-->
<!--            </div>-->
<!--            <div class="file-info">-->
<!--                <h1>{{ doc_data.filename }}</h1>-->
<!--                <p>ä¸Šä¼ æ—¶é—´: {{ doc_data.uploaded_at }}</p>-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="header-actions">-->
<!--            {% if session_data and session_data.session_id %}-->
<!--            <a href="/view/{{ session_data.session_id }}" class="header-btn">â† è¿”å›</a>-->
<!--            {% endif %}-->
<!--            <a href="/" class="header-btn">ğŸ  ä¸»é¡µ</a>-->
<!--        </div>-->
<!--    </div>-->

<!--    &lt;!&ndash; Officeé£æ ¼å·¥å…·æ  &ndash;&gt;-->
<!--    <div class="office-toolbar">-->
<!--        {% if doc_type == 'word' %}-->
<!--            <div class="toolbar-group">-->
<!--                <span>å­—ä½“å¤§å°:</span>-->
<!--                <button class="toolbar-btn" onclick="adjustWordFontSize(-1)">A-</button>-->
<!--                <span id="word-font-size">14px</span>-->
<!--                <button class="toolbar-btn" onclick="adjustWordFontSize(1)">A+</button>-->
<!--            </div>-->
<!--            <div class="toolbar-group">-->
<!--                <button class="toolbar-btn" onclick="resetWordView()">é‡ç½®è§†å›¾</button>-->
<!--            </div>-->
<!--        {% elif doc_type == 'ppt' %}-->
<!--            <div class="toolbar-group">-->
<!--                <span>å½“å‰:</span>-->
<!--                <span id="ppt-current-info">å¹»ç¯ç‰‡ 1</span>-->
<!--            </div>-->
<!--            <div class="toolbar-group">-->
<!--                <button class="toolbar-btn" onclick="togglePPTFullscreen()">å…¨å±æŸ¥çœ‹</button>-->
<!--            </div>-->
<!--        {% elif doc_type == 'excel' %}-->
<!--            <div class="toolbar-group">-->
<!--                <span>ç¼©æ”¾:</span>-->
<!--                <button class="toolbar-btn" onclick="adjustExcelZoom(-10)">-</button>-->
<!--                <span id="excel-zoom">100%</span>-->
<!--                <button class="toolbar-btn" onclick="adjustExcelZoom(10)">+</button>-->
<!--            </div>-->
<!--            <div class="toolbar-group">-->
<!--                <span id="excel-info">é€‰æ‹©å·¥ä½œè¡¨</span>-->
<!--            </div>-->
<!--        {% endif %}-->
<!--        <div class="toolbar-group">-->
<!--            {% if session_data and session_data.session_id %}-->
<!--            <span>ä¼šè¯: {{ session_data.session_id }}</span>-->
<!--            {% endif %}-->
<!--        </div>-->
<!--    </div>-->

<!--    &lt;!&ndash; ä¸»è¦å†…å®¹åŒºåŸŸ &ndash;&gt;-->
<!--    <div class="office-content">-->
<!--        <div class="document-viewer">-->
<!--            {% if doc_type == 'word' %}-->
<!--                &lt;!&ndash; Wordæ–‡æ¡£æŸ¥çœ‹å™¨ &ndash;&gt;-->
<!--                <div class="word-page">-->
<!--                    <div class="word-content" id="word-content">-->
<!--                        {% if doc_data.content %}-->
<!--                            <pre>{{ doc_data.content }}</pre>-->
<!--                        {% else %}-->
<!--                            <div class="empty-state">-->
<!--                                <div class="empty-icon">ğŸ“</div>-->
<!--                                <h3>æ–‡æ¡£ä¸ºç©º</h3>-->
<!--                                <p>æ­¤Wordæ–‡æ¡£æ²¡æœ‰å†…å®¹</p>-->
<!--                            </div>-->
<!--                        {% endif %}-->
<!--                    </div>-->
<!--                </div>-->

<!--            {% elif doc_type == 'ppt' %}-->
<!--                &lt;!&ndash; PPTæ¼”ç¤ºæ–‡ç¨¿æŸ¥çœ‹å™¨ &ndash;&gt;-->
<!--                <div class="ppt-viewer">-->
<!--                    {% if doc_data.content and doc_data.content is iterable and doc_data.content|length > 0 %}-->
<!--                        {% set first_slide = doc_data.content[0] %}-->
<!--                        {% if first_slide.get('error') %}-->
<!--                            <div class="error-state">{{ first_slide.error }}</div>-->
<!--                        {% else %}-->
<!--                            <div class="slide-navigation">-->
<!--                                <button class="nav-button" onclick="previousSlide()" id="prev-slide-btn">-->
<!--                                    â† ä¸Šä¸€å¼ -->
<!--                                </button>-->
<!--                                <div class="slide-counter" id="slide-counter">-->
<!--                                    1 / {{ doc_data.content|length }}-->
<!--                                </div>-->
<!--                                <button class="nav-button" onclick="nextSlide()" id="next-slide-btn">-->
<!--                                    ä¸‹ä¸€å¼  â†’-->
<!--                                </button>-->
<!--                            </div>-->

<!--                            <div class="slide-container">-->
<!--                                {% for slide in doc_data.content %}-->
<!--                                    <div class="slide {% if loop.first %}active{% endif %}" id="slide-{{ loop.index }}">-->
<!--                                        <h2>{{ slide.slide_number }}.-->
<!--                                            {% if slide.content and slide.content|length > 0 %}-->
<!--                                                {% set first_line = slide.content[0] %}-->
<!--                                                {% if first_line|length > 30 %}-->
<!--                                                    {{ first_line[:30] }}...-->
<!--                                                {% else %}-->
<!--                                                    {{ first_line }}-->
<!--                                                {% endif %}-->
<!--                                            {% else %}-->
<!--                                                å¹»ç¯ç‰‡ {{ slide.slide_number }}-->
<!--                                            {% endif %}-->
<!--                                        </h2>-->
<!--                                        {% if slide.content and slide.content|length > 0 %}-->
<!--                                            {% for text in slide.content %}-->
<!--                                                <p>{{ text }}</p>-->
<!--                                            {% endfor %}-->
<!--                                        {% else %}-->
<!--                                            <div class="empty-state">-->
<!--                                                <div class="empty-icon">ğŸ“Š</div>-->
<!--                                                <p>æ­¤å¹»ç¯ç‰‡æ— æ–‡æœ¬å†…å®¹</p>-->
<!--                                            </div>-->
<!--                                        {% endif %}-->
<!--                                    </div>-->
<!--                                {% endfor %}-->
<!--                            </div>-->
<!--                        {% endif %}-->
<!--                    {% else %}-->
<!--                        <div class="error-state">PPTå†…å®¹ä¸ºç©ºæˆ–æ ¼å¼é”™è¯¯</div>-->
<!--                    {% endif %}-->
<!--                </div>-->

<!--            {% elif doc_type == 'excel' %}-->
<!--                &lt;!&ndash; Excelè¡¨æ ¼æŸ¥çœ‹å™¨ &ndash;&gt;-->
<!--                <div class="excel-viewer">-->
<!--                    {% if doc_data.content and not doc_data.content.get('error') %}-->
<!--                        {% set sheet_names = [] %}-->
<!--                        {% for sheet_name in doc_data.content.keys() %}-->
<!--                            {% if sheet_name != 'error' %}-->
<!--                                {% set _ = sheet_names.append(sheet_name) %}-->
<!--                            {% endif %}-->
<!--                        {% endfor %}-->

<!--                        {% if sheet_names|length > 0 %}-->
<!--                            <div class="sheet-tabs">-->
<!--                                {% for sheet_name in sheet_names %}-->
<!--                                    <button class="sheet-tab {% if loop.first %}active{% endif %}"-->
<!--                                            onclick="switchExcelSheet('{{ loop.index }}', '{{ sheet_name }}', this)">-->
<!--                                        ğŸ“„ {{ sheet_name }}-->
<!--                                    </button>-->
<!--                                {% endfor %}-->
<!--                            </div>-->

<!--                            <div class="excel-content" id="excel-zoom-container">-->
<!--                                {% for sheet_name in sheet_names %}-->
<!--                                    <div class="excel-sheet {% if loop.first %}active{% endif %}"-->
<!--                                         id="excel-sheet-{{ loop.index }}">-->
<!--                                        {% set table_html = doc_data.content[sheet_name] %}-->
<!--                                        {% if table_html %}-->
<!--                                            <div class="table-wrapper">{{ table_html|safe }}</div>-->
<!--                                        {% else %}-->
<!--                                            <div class="empty-state">-->
<!--                                                <div class="empty-icon">ğŸ“Š</div>-->
<!--                                                <h3>å·¥ä½œè¡¨ä¸ºç©º</h3>-->
<!--                                                <p>æ­¤å·¥ä½œè¡¨æ²¡æœ‰æ•°æ®</p>-->
<!--                                            </div>-->
<!--                                        {% endif %}-->
<!--                                    </div>-->
<!--                                {% endfor %}-->
<!--                            </div>-->
<!--                        {% else %}-->
<!--                            <div class="error-state">Excelæ–‡ä»¶ä¸åŒ…å«ä»»ä½•å·¥ä½œè¡¨</div>-->
<!--                        {% endif %}-->
<!--                    {% else %}-->
<!--                        <div class="error-state">-->
<!--                            {% if doc_data.content and doc_data.content.get('error') %}-->
<!--                                {{ doc_data.content.error }}-->
<!--                            {% else %}-->
<!--                                Excelå†…å®¹ä¸ºç©ºæˆ–æ ¼å¼é”™è¯¯-->
<!--                            {% endif %}-->
<!--                        </div>-->
<!--                    {% endif %}-->
<!--                </div>-->
<!--            {% else %}-->
<!--                &lt;!&ndash; æœªçŸ¥æ–‡æ¡£ç±»å‹ &ndash;&gt;-->
<!--                <div class="error-state">-->
<!--                    <h3>ä¸æ”¯æŒçš„æ–‡æ¡£ç±»å‹</h3>-->
<!--                    <p>å½“å‰æ–‡æ¡£ç±»å‹: {{ doc_type or 'æœªçŸ¥' }}</p>-->
<!--                </div>-->
<!--            {% endif %}-->
<!--        </div>-->
<!--    </div>-->

<!--&lt;!&ndash; 1. æ•°æ®å­˜å‚¨åœ¨HTML dataå±æ€§ä¸­ &ndash;&gt;-->
<!--<div id="template-data" style="display: none;"-->
<!--     data-doc-type="{{ doc_type or '' }}"-->
<!--     data-total-slides="{% if doc_type == 'ppt' and doc_data and doc_data.content %}{{ doc_data.content|length }}{% else %}0{% endif %}">-->
<!--</div>-->

<!--&lt;!&ndash; 2. JavaScriptè¯»å–dataå±æ€§ &ndash;&gt;-->
<!--<script>-->
<!--function getTemplateData() {-->
<!--    const dataElement = document.getElementById('template-data');-->
<!--    return {-->
<!--        docType: dataElement.getAttribute('data-doc-type') || '',-->
<!--        totalSlides: parseInt(dataElement.getAttribute('data-total-slides')) || 0-->
<!--    };-->
<!--}-->
<!--</script>-->
<!--&lt;!&ndash;</script>&ndash;&gt;-->
<!--&lt;!&ndash;    <script type="text/javascript">&ndash;&gt;-->
<!--&lt;!&ndash;        // ä»æ¨¡æ¿å®‰å…¨åœ°ä¼ é€’æ•°æ®åˆ°JavaScript&ndash;&gt;-->
<!--&lt;!&ndash;        window.templateData = {};&ndash;&gt;-->
<!--&lt;!&ndash;        window.templateData.docType = "{{ doc_type or '' }}";&ndash;&gt;-->
<!--&lt;!&ndash;        {% if doc_type == 'ppt' and doc_data and doc_data.content %}&ndash;&gt;-->
<!--&lt;!&ndash;        window.templateData.totalSlides = {{ doc_data.content|length }};&ndash;&gt;-->
<!--&lt;!&ndash;        {% else %}&ndash;&gt;-->
<!--&lt;!&ndash;        window.templateData.totalSlides = 0;&ndash;&gt;-->
<!--&lt;!&ndash;        {% endif %}&ndash;&gt;-->
<!--&lt;!&ndash;        {% if doc_data and doc_data.content %}&ndash;&gt;-->
<!--&lt;!&ndash;        window.templateData.hasContent = true;&ndash;&gt;-->
<!--&lt;!&ndash;        {% else %}&ndash;&gt;-->
<!--&lt;!&ndash;        window.templateData.hasContent = false;&ndash;&gt;-->
<!--&lt;!&ndash;        {% endif %}&ndash;&gt;-->
<!--&lt;!&ndash;    </script>&ndash;&gt;-->

<!--    <script>-->
<!--        // å…¨å±€å˜é‡-->
<!--        let currentWordFontSize = 14;-->
<!--        let currentSlideIndex = 1;-->
<!--        let totalSlides = (window.templateData && window.templateData.totalSlides) ? window.templateData.totalSlides : 0;-->
<!--        let currentExcelZoom = 100;-->

<!--        // Wordæ–‡æ¡£ç›¸å…³å‡½æ•°-->
<!--        function adjustWordFontSize(delta) {-->
<!--            currentWordFontSize += delta;-->
<!--            if (currentWordFontSize < 10) currentWordFontSize = 10;-->
<!--            if (currentWordFontSize > 24) currentWordFontSize = 24;-->

<!--            const content = document.getElementById('word-content');-->
<!--            const display = document.getElementById('word-font-size');-->

<!--            if (content) {-->
<!--                content.style.fontSize = currentWordFontSize + 'px';-->
<!--            }-->
<!--            if (display) {-->
<!--                display.textContent = currentWordFontSize + 'px';-->
<!--            }-->
<!--        }-->

<!--        function resetWordView() {-->
<!--            currentWordFontSize = 14;-->
<!--            adjustWordFontSize(0);-->
<!--        }-->

<!--        // PPTç›¸å…³å‡½æ•°-->
<!--        function showSlide(index) {-->
<!--            if (index < 1 || index > totalSlides || totalSlides === 0) return;-->

<!--            // éšè—æ‰€æœ‰å¹»ç¯ç‰‡-->
<!--            document.querySelectorAll('.slide').forEach(function(slide) {-->
<!--                slide.classList.remove('active');-->
<!--            });-->

<!--            // æ˜¾ç¤ºç›®æ ‡å¹»ç¯ç‰‡-->
<!--            const targetSlide = document.getElementById('slide-' + index);-->
<!--            if (targetSlide) {-->
<!--                targetSlide.classList.add('active');-->
<!--            }-->

<!--            // æ›´æ–°è®¡æ•°å™¨-->
<!--            const counter = document.getElementById('slide-counter');-->
<!--            const info = document.getElementById('ppt-current-info');-->
<!--            if (counter) {-->
<!--                counter.textContent = index + ' / ' + totalSlides;-->
<!--            }-->
<!--            if (info) {-->
<!--                info.textContent = 'å¹»ç¯ç‰‡ ' + index;-->
<!--            }-->

<!--            // æ›´æ–°æŒ‰é’®çŠ¶æ€-->
<!--            const prevBtn = document.getElementById('prev-slide-btn');-->
<!--            const nextBtn = document.getElementById('next-slide-btn');-->
<!--            if (prevBtn) prevBtn.disabled = (index === 1);-->
<!--            if (nextBtn) nextBtn.disabled = (index === totalSlides);-->

<!--            currentSlideIndex = index;-->
<!--        }-->

<!--        function previousSlide() {-->
<!--            if (currentSlideIndex > 1) {-->
<!--                showSlide(currentSlideIndex - 1);-->
<!--            }-->
<!--        }-->

<!--        function nextSlide() {-->
<!--            if (currentSlideIndex < totalSlides) {-->
<!--                showSlide(currentSlideIndex + 1);-->
<!--            }-->
<!--        }-->

<!--        function togglePPTFullscreen() {-->
<!--            try {-->
<!--                if (!document.fullscreenElement) {-->
<!--                    document.documentElement.requestFullscreen();-->
<!--                } else {-->
<!--                    document.exitFullscreen();-->
<!--                }-->
<!--            } catch (error) {-->
<!--                console.warn('å…¨å±åŠŸèƒ½ä¸æ”¯æŒ:', error);-->
<!--            }-->
<!--        }-->

<!--        // Excelç›¸å…³å‡½æ•°-->
<!--        function switchExcelSheet(sheetIndex, sheetName, clickedBtn) {-->
<!--            // éšè—æ‰€æœ‰å·¥ä½œè¡¨-->
<!--            document.querySelectorAll('.excel-sheet').forEach(function(sheet) {-->
<!--                sheet.classList.remove('active');-->
<!--            });-->

<!--            // æ˜¾ç¤ºç›®æ ‡å·¥ä½œè¡¨-->
<!--            const targetSheet = document.getElementById('excel-sheet-' + sheetIndex);-->
<!--            if (targetSheet) {-->
<!--                targetSheet.classList.add('active');-->
<!--            }-->

<!--            // æ›´æ–°æ ‡ç­¾çŠ¶æ€-->
<!--            document.querySelectorAll('.sheet-tab').forEach(function(tab) {-->
<!--                tab.classList.remove('active');-->
<!--            });-->
<!--            if (clickedBtn) {-->
<!--                clickedBtn.classList.add('active');-->
<!--            }-->

<!--            // æ›´æ–°ä¿¡æ¯æ˜¾ç¤º-->
<!--            const info = document.getElementById('excel-info');-->
<!--            if (info) {-->
<!--                info.textContent = 'å½“å‰: ' + sheetName;-->
<!--            }-->

<!--            // å¢å¼ºè¡¨æ ¼æ ·å¼-->
<!--            enhanceExcelTable(targetSheet);-->
<!--        }-->

<!--        function adjustExcelZoom(delta) {-->
<!--            currentExcelZoom += delta;-->
<!--            if (currentExcelZoom < 50) currentExcelZoom = 50;-->
<!--            if (currentExcelZoom > 200) currentExcelZoom = 200;-->

<!--            const display = document.getElementById('excel-zoom');-->
<!--            const container = document.getElementById('excel-zoom-container');-->

<!--            if (display) {-->
<!--                display.textContent = currentExcelZoom + '%';-->
<!--            }-->
<!--            if (container) {-->
<!--                container.style.transform = 'scale(' + (currentExcelZoom / 100) + ')';-->
<!--                container.style.transformOrigin = 'top left';-->
<!--            }-->
<!--        }-->

<!--        function enhanceExcelTable(sheetElement) {-->
<!--            if (!sheetElement) return;-->

<!--            const table = sheetElement.querySelector('table');-->
<!--            if (!table) return;-->

<!--            // æ·»åŠ Excelæ ·å¼ç±»-->
<!--            table.className = 'excel-table';-->

<!--            // å¤„ç†è¡¨å¤´-->
<!--            const headerRow = table.querySelector('tr');-->
<!--            if (headerRow) {-->
<!--                const firstHeader = headerRow.querySelector('th');-->
<!--                if (firstHeader && !firstHeader.textContent.trim()) {-->
<!--                    firstHeader.textContent = '#';-->
<!--                }-->
<!--            }-->

<!--            // ä¸ºè¡Œæ·»åŠ è¡Œå·-->
<!--            const rows = table.querySelectorAll('tr');-->
<!--            rows.forEach(function(row, index) {-->
<!--                if (index === 0) return; // è·³è¿‡è¡¨å¤´-->

<!--                const firstCell = row.querySelector('td');-->
<!--                if (firstCell && !firstCell.textContent.trim()) {-->
<!--                    firstCell.textContent = index;-->
<!--                }-->

<!--                // ä¸ºæ•°æ®å•å…ƒæ ¼æ·»åŠ ç±»å‹æ ·å¼-->
<!--                const cells = row.querySelectorAll('td:not(:first-child)');-->
<!--                cells.forEach(function(cell) {-->
<!--                    const text = cell.textContent.trim();-->
<!--                    if (!isNaN(text) && text !== '') {-->
<!--                        cell.classList.add('cell-number');-->
<!--                    } else if (/^\d{4}-\d{2}-\d{2}/.test(text)) {-->
<!--                        cell.classList.add('cell-date');-->
<!--                    } else if (text.startsWith('=')) {-->
<!--                        cell.classList.add('cell-formula');-->
<!--                    }-->
<!--                });-->
<!--            });-->
<!--        }-->

<!--        // é”®ç›˜äº‹ä»¶å¤„ç†-->
<!--        document.addEventListener('keydown', function(event) {-->
<!--            const docType = (window.templateData && window.templateData.docType) ? window.templateData.docType : '';-->

<!--            if (docType === 'ppt') {-->
<!--                if (event.key === 'ArrowLeft' || event.key === 'ArrowUp') {-->
<!--                    event.preventDefault();-->
<!--                    previousSlide();-->
<!--                } else if (event.key === 'ArrowRight' || event.key === 'ArrowDown') {-->
<!--                    event.preventDefault();-->
<!--                    nextSlide();-->
<!--                } else if (event.key === 'F11') {-->
<!--                    event.preventDefault();-->
<!--                    togglePPTFullscreen();-->
<!--                }-->
<!--            }-->

<!--            if (docType === 'excel') {-->
<!--                if (event.ctrlKey || event.metaKey) {-->
<!--                    if (event.key === '+' || event.key === '=') {-->
<!--                        event.preventDefault();-->
<!--                        adjustExcelZoom(10);-->
<!--                    } else if (event.key === '-') {-->
<!--                        event.preventDefault();-->
<!--                        adjustExcelZoom(-10);-->
<!--                    } else if (event.key === '0') {-->
<!--                        event.preventDefault();-->
<!--                        currentExcelZoom = 100;-->
<!--                        adjustExcelZoom(0);-->
<!--                    }-->
<!--                }-->
<!--            }-->
<!--        });-->

<!--        // é¡µé¢åˆå§‹åŒ–-->
<!--        document.addEventListener('DOMContentLoaded', function() {-->
<!--            const docType = (window.templateData && window.templateData.docType) ? window.templateData.docType : '';-->

<!--            if (docType === 'word') {-->
<!--                // åˆå§‹åŒ–Wordå­—ä½“å¤§å°æ˜¾ç¤º-->
<!--                const fontDisplay = document.getElementById('word-font-size');-->
<!--                if (fontDisplay) {-->
<!--                    fontDisplay.textContent = currentWordFontSize + 'px';-->
<!--                }-->
<!--            }-->

<!--            if (docType === 'ppt') {-->
<!--                // åˆå§‹åŒ–PPT-->
<!--                if (totalSlides > 0) {-->
<!--                    showSlide(1);-->
<!--                }-->
<!--            }-->

<!--            if (docType === 'excel') {-->
<!--                // åˆå§‹åŒ–Excel-->
<!--                const firstSheet = document.querySelector('.excel-sheet.active');-->
<!--                if (firstSheet) {-->
<!--                    enhanceExcelTable(firstSheet);-->
<!--                }-->

<!--                // åˆå§‹åŒ–ç¼©æ”¾æ˜¾ç¤º-->
<!--                const zoomDisplay = document.getElementById('excel-zoom');-->
<!--                if (zoomDisplay) {-->
<!--                    zoomDisplay.textContent = currentExcelZoom + '%';-->
<!--                }-->
<!--            }-->

<!--            console.log('OfficeæŸ¥çœ‹å™¨åŠ è½½å®Œæˆ - ' + docType);-->
<!--        });-->
<!--    </script>-->
<!--</body>-->
<!--</html>-->
